function $_global_sharing(){if("undefined"==typeof g_all_modules)g_all_modules={};g_all_modules["sharing.js"]={version:{rmj:16,rmm:0,rup:5173,rpr:1e3}};typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkBegin_sharing.js");if(typeof ElementCreator==="undefined")ElementCreator=function(d,b){var a=Boolean(b)?b:document.createElement("textarea");switch(d.toLowerCase()){case"textarea":c()}return a;function c(){var i="placeholder"in a,e;if(i){var g=document.createElement("div");g.className="ms-helperText ms-hide";document.body.appendChild(g);var j=CSSUtil.getCurrentStyleCorrect(g,"color","color");document.body.removeChild(g);var h=false,o=document.getElementsByTagName("head")[0],b=document.createElement("style");b.type="text/css";var c="::-webkit-input-placeholder { color:#color; } ::-moz-placeholder { color:#color; opacity:1; } :-ms-input-placeholder { color:#color; } input:-moz-placeholder { color:#color; opacity:1; }";c=c.replace(/#color/g,j);try{if(typeof b.styleSheet!="undefined"&&b.styleSheet!=null&&typeof b.styleSheet.cssText!="undefined"){b.styleSheet.cssText=c;h=true}}catch(p){}!h&&b.appendChild(document.createTextNode(c));o.appendChild(b)}else{var f=true,d="";a.setAttribute("value","");Object.defineProperty(Object(a),"placeholder",{"get":function(){return d},"set":function(b){d=b;e(a.value);return d}});Object.defineProperty(Object(a),"value",{"get":function(){return f?"":a.innerText},"set":function(b){e(b);return a.value}});var m=a.getAttribute;a.getAttribute=function(b){var c=b!=null?b.toLowerCase():null;return c=="value"?this.value:m.call(a,b)};var n=a.setAttribute;a.setAttribute=function(b,c){var d=b!=null?b.toLowerCase():null;if(d=="placeholder")this.placeholder=c;else n.call(a,b,c)};e=function(b){f=b==""||b==null;if(f){CSSUtil.AddClass(a,"ms-helperText");a.innerText=d}else{CSSUtil.RemoveClass(a,"ms-helperText");a.innerText=b}};var k=function(){if(f){CSSUtil.RemoveClass(a,"ms-helperText");a.innerText=""}},l=function(){e(a.innerText)};AddEvtHandler(a,"onfocus",k,false);AddEvtHandler(a,"onblur",l,false)}}};companySharingLinksFlightOn=false;expiryFlightOn=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(422);simpleSiteSharingFeature=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(451);sharingInfoRefactorFeature=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(473);SharingTabToShow={SharingDialog:0,GetLinks:1,SharedWith:2};SharingDialogReturnCode={Success:0,Cancel:1,Error:2};SharingRole={None:0,View:1,Edit:2,Owner:3};SharingLinkKind={Uninitialized:0,Direct:1,OrganizationView:2,OrganizationEdit:3,AnonymousView:4,AnonymousEdit:5};SharingLinkExpirationValues={};L_SelectedSharingLinkKind=SharingLinkKind.OrganizationEdit;(function(){function i(b){var d=null,a=null,c=null,p=b,e=new Renderer;j(e);g();this.open=function(){h();l();o()};this.close=function(){m();k()};this.setPendingState=function(d){if(!Boolean(a))return;var e=a.querySelector(".ms-confirmDialog-loadingImg");e.style.display=d?"inline":"none";for(var c=a.querySelectorAll(".ms-confirmDialog-button"),b=0;b<c.length;b++)c[b].disabled=d};function j(a){a.SetTemplate("overlay",'{%version 2.0}<div class="ms-confirmDialog-overlay"></div>');a.SetTemplate("root",'{%version 2.0}<div class="ms-confirmDialog-container ms-absoluteCenter" role="dialog"><div class="ms-confirmDialog-content"><div class="ms-confirmDialog-title">{=title}</div><div class="ms-confirmDialog-body">{=message}</div><div class="ms-confirmDialog-commandBar">{%template loadingImg}{%foreach buttonTemplate buttons}</div></div></div>');a.SetTemplate("loadingImg",'{%version 2.0}<img src="{=loadingImgUrl}" class="ms-confirmDialog-loadingImg" onclick="{+hideLoadingImage}" />');a.SetTemplate("buttonTemplate",'{%version 2.0}<input class="ms-confirmDialog-button" onclick="{+buttonClick .}" type="button" value="{=text}"></input>')}function g(){e.RegisterHandler("buttonClick",a);e.RegisterHandler("hideLoadingImage",b);function a(b,a){return a.onclick(b)}function b(){this.style.display="none"}}function n(b,c){var a=document.createElement("div");a.innerHTML=e.Render(b,c);return a.removeChild(a.firstChild)}function h(){if(Boolean(c))return;c=n("overlay");document.body.appendChild(c)}function k(){if(!Boolean(c))return;document.body.removeChild(c);c=null}function l(){d=document.createElement("div");var b=Accessibility.CreateTabLoopContainer(d),c=f();b.innerHTML=e.Render("root",c);a=b.firstChild;document.body.appendChild(d);Accessibility.FocusFirstTabStop(a)}function m(){document.body.removeChild(d);d=null;a=null}function f(){var a={};a.title=Encoding.HtmlEncode(b.title);a.message=Encoding.HtmlEncode(b.message);for(var d=[],c=0;c<b.buttons.length;c++){var f=Encoding.HtmlEncode(String(b.buttons[c].text)),e=b.buttons[c].onclick;d.push({text:f,onclick:e})}a.buttons=d;a.loadingImgUrl=i.Resources.LoadingImgUrl;return a}function o(){if(!Boolean(a))return;var b=a.querySelector(".ms-confirmDialog-content"),d=b.offsetWidth,c=b.offsetHeight;a.style.width=String(d)+"px";a.style.height=String(c)+"px"}}i.CreateStandardSettings=function(g,f,a,b){var c={text:i.Resources.GetString("L_ConfirmDialogDefaultConfirmText"),onclick:a},d={text:i.Resources.GetString("L_ConfirmDialogDefaultCancelText"),onclick:b},e={title:g,message:f,buttons:[c,d]};return e};i.Resources={};i.Resources.GetString=function(a){return window.Strings.STS[a]};i.Resources.LoadingImgUrl="/_layouts/15/images/loadingcirclests16.gif?rev=40";function tb(o,r,q,p){var c=o,f=r,e=q,d=p,b=false,a=null;this.Initialize=function(a){b=Boolean(a.CanBeUnshared);if(b){g();l()}};this.ShowLinkIfNeeded=function(){if(b)c.style.display="inline"};function g(){var b=k();a=new i(b)}function l(){c.addEventListener("click",h,false)}function h(){a.open()}function k(){var a=i.CreateStandardSettings(Strings.STS.L_StopSharingDialogTitle,Strings.STS.L_StopSharingDialogText,m,n);a.buttons[0].text=Strings.STS.L_StopSharing;a.buttons[1].text=Strings.STS.L_CancelButtonCaption;return a}function m(){a.setPendingState(true);UnshareObject(g,c,f,e,d);function g(){h();mb();a.close();DisplaySharedWithDialog(f,e,d);b()}function c(){a.close();DisplaySharedWithDialog(f,e,d);b()}function b(){var a=document.getElementById("lnkSharedWithDlg");Boolean(a)&&a.focus()}function h(){L_AnonymousViewLink=null;L_AnonymousEditLink=null;var a=GetManageLinkParams();j(a,SharingLinkKind.OrganizationView,null);j(a,SharingLinkKind.OrganizationEdit,null);j(a,SharingLinkKind.AnonymousView,null);j(a,SharingLinkKind.AnonymousEdit,null)}}function n(){a.close();c.focus()}}var X=function(){};X.prototype={showSharingHintImages:false,showSharedWithNoneLink:false,appendCountToSharedWithListUserLinkId:false,appendCountToSharedWithMoreLinkId:false,sharedWithListDivId:"",sharedWithListDivClass:"",sharedWithListImageId:"",sharedWithListImageClass:"",sharedWithListInnerSpanId:"",sharedWithListInnerSpanClass:"",sharedWithListUserLinkId:"",sharedWithListUserLinkClass:"",sharedWithNoneLinkId:"",sharedWithNoneLinkClass:"",sharedWithMoreLinkId:"",sharedWithMoreLinkClass:"",sharedWithManyLinkId:"",sharedWithManyLinkClass:"",guestLinkDivId:"",guestLinkDivClass:"",guestLinkImageId:"",guestLinkImageClass:"",guestLinkInnerSpanId:"",guestLinkInnerSpanClass:"",guestLinkId:"",guestLinkClass:"",guestLinkOnClickCallback:""};function jb(d,c){var a=new X;if(d){a.showSharingHintImages=true;a.showSharedWithNoneLink=true;a.appendCountToSharedWithListUserLinkId=true;a.appendCountToSharedWithMoreLinkId=true;a.sharedWithListDivClass="ms-core-form-line ms-textSmall";a.sharedWithListImageId="js-sharingdlg-imageUserAccess";a.sharedWithListImageClass="ms-verticalAlignTop";a.sharedWithListInnerSpanId="js-sharingdlg-labelUserAccess";a.sharedWithListInnerSpanClass="ms-aclinv-label ms-verticalAlignTop ms-soften";a.sharedWithListUserLinkId="js-sharingdlg-user";a.sharedWithNoneLinkId="js-sharingdlg-notshared";a.sharedWithNoneLinkClass="js-sharingdlg-sharedWithLink";a.sharedWithMoreLinkId="js-sharingdlg-nmore-";a.sharedWithMoreLinkClass="js-sharingdlg-sharedWithLink";a.sharedWithManyLinkId="js-sharingdlg-lotspeople";a.sharedWithManyLinkClass="js-sharingdlg-sharedWithLink";a.guestLinkDivId="js-sharingdlg-guestLinkDiv";a.guestLinkDivClass="ms-core-form-line ms-textSmall";a.guestLinkImageId="js-sharingdlg-imageGuestLink";a.guestLinkImageClass="ms-verticalAlignTop";a.guestLinkInnerSpanId="js-sharingdlg-labelGuestLink";a.guestLinkInnerSpanClass="ms-aclinv-label ms-verticalAlignTop ms-soften";a.guestLinkId="js-sharingdlg-guestLink";a.guestLinkClass="js-sharingdlg-guestLink";a.guestLinkOnClickCallback="ResizeDialogSuppressScrollBar(ManageLink);"}else{var b="";if(m$.isDefinedAndNotNull(c))b=GetCalloutElementIDFromCallout(c);a.sharedWithListDivClass="js-callout-sharedWithList";a.sharedWithListUserLinkClass="js-callout-sharedWithDisplayNameLink";a.showSharedWithNoneLink=true;a.sharedWithNoneLinkId=b+"js-callout-notshared";a.sharedWithNoneLinkClass="js-callout-sharedWithLink";a.sharedWithMoreLinkId=b+"SharedWithLink";a.sharedWithMoreLinkClass="js-callout-sharedWithLink";a.sharedWithManyLinkId=b+"SharedWithLink";a.sharedWithManyLinkClass="js-callout-sharedWithLink";a.guestLinkDivClass="js-callout-sharedWithManageLinks";a.guestLinkId=b+"GuestLink";a.guestLinkClass="js-callout-sharedWithGuestLink"}return a}function b(c,a){var b="";if(m$.isDefinedAndNotNull(a)&&a.length>0)b=" "+c+"="+StAttrQuote(a)+" ";return b}function ub(){return false}GetSharingStatusHtml=function(d,n,l,v,E,L,z,p,A,y,o){var a=jb(E,A),c=[],m="";if(d.length===0&&!l&&!n){if(!v){var r="",q="";if(a.showSharedWithNoneLink){r='<a href="#" onclick="return false;"'+b("id",a.sharedWithNoneLinkId)+b("class",a.sharedWithNoneLinkClass)+">";q="</a>"}c.push(r,Strings.STS.L_SharedWithNone,q);m="js-sharingHint-unshared"}}else{m="js-sharingHint-sharedDefault";var i="";if(isDefinedAndNotNullOrEmpty(z))i=StBuildParam(Strings.STS.L_SharedWithTooltip,z);if(Boolean(y)){var e=0,j=0,x=false;if(l||n){for(var k=0;k<d.length;k++)if(d[k].isDomainGroup){e++;if(ub(d[k])){x=true;break}}j=d.length-e}var g='<a tabIndex="999" href="#" onclick="return false;"'+b("id",a.sharedWithManyLinkId)+b("title",i)+b("class",a.sharedWithManyLinkClass)+">",f="</a>";if(x)c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithEveryOne),g,f));else if(e==0){var J=StBuildParam(SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_SharedWithNumPeople),Encoding.HtmlEncode(Strings.STS.L_SharedWithNumPeopleInterval),d.length),d.length);c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGroupOrPeople),g+J+f))}else if(j==0){var K=StBuildParam(SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_SharedWithNumGroup),Encoding.HtmlEncode(Strings.STS.L_SharedWithNumGroupInterval),d.length),d.length);c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGroupOrPeople),g+K+f))}else{var H=StBuildParam(SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_SharedWithNumGroup),Encoding.HtmlEncode(Strings.STS.L_SharedWithNumGroupInterval),e),e),G=StBuildParam(SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_SharedWithNumPeople),Encoding.HtmlEncode(Strings.STS.L_SharedWithNumPeopleInterval),j),j);c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGroupPeople),g+H,G+f))}}else if(l||n){var C='<a href="#" onclick="return false;"'+b("id",a.sharedWithManyLinkId)+b("title",i)+b("class",a.sharedWithManyLinkClass)+">",B="</a>";c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithMany),C,B))}else{var I={HasUserLink:true,DefaultRender:true,AllowMultipleValues:true,InlineRender:true,InlineRenderMoreAsLink:true},M={EffectivePresenceEnabled:"1",PresenceAlt:Strings.STS.L_UserFieldNoUserPresenceAlt,UserDispUrl:L},D=GetReversedSharedWithUsers(d),F=d.length,h=document.createElement("div");EnsureScriptFunc("clienttemplates.js","UserFieldRenderer",function(){var f=new UserFieldRenderer("SharedWith");h.innerHTML=f.RenderField(p,I,{SharedWith:D},M);var d=0,b=m$(h).find(".ms-imnSpan");b.forEach(function(f){var e=a.sharedWithListUserLinkClass,c=a.sharedWithListUserLinkId;if(a.appendCountToSharedWithListUserLinkId)c+=String(b.length-d);if(m$.isDefinedAndNotNull(c)&&c.length>0)f.id=c;m$.isDefinedAndNotNull(e)&&e.length>0&&m$(f).addClass(e);d++});var e=m$(h).find(".ms-imnMoreLink");e.forEach(function(e){var g=F-3,f=a.sharedWithMoreLinkId;if(a.appendCountToSharedWithMoreLinkId)f+=String(g);var c=a.sharedWithMoreLinkClass,b=i,d=f;if(m$.isDefinedAndNotNull(d)&&d.length>0)e.id=d;m$.isDefinedAndNotNull(c)&&c.length>0&&m$(e).addClass(c);if(m$.isDefinedAndNotNull(b)&&b.length>0)e.title=b});c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithUsers),h.innerHTML))})}}if(c.length>0){c.unshift("<span",b("id",a.sharedWithListInnerSpanId),b("class",a.sharedWithListInnerSpanClass),">");c.push("</span>");var t="";if(a.showSharingHintImages){t=U(a.sharedWithListImageClass,m,a.sharedWithListImageId);c.unshift(t)}c.unshift("<div",b("id",a.sharedWithListDivId),b("class",a.sharedWithListDivClass),">");c.push("</div>")}if(v){var s="";if(a.showSharingHintImages)s=U(a.guestLinkImageClass,"js-sharingHint-sharedAnonymously",a.guestLinkImageId);if(!m$.isDefinedAndNotNull(A))w=StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGuest),"","");else var w=StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGuest),'<a href="#"'+b("onclick",a.guestLinkOnClickCallback+"return false;")+b("id",a.guestLinkId)+b("title",Strings.STS.L_SharedWithGuestTooltip)+b("class",a.guestLinkClass)+">","</a>");c.push("<div",b("id",a.guestLinkDivId),b("class",a.guestLinkDivClass),">",s,"<span",b("id",a.guestLinkInnerSpanId),b("class",a.guestLinkInnerSpanClass),">",w,"</span>","</div>")}if(!y){var N=Boolean(p)?p.listName:L_ListID;if(!Boolean(o))o=L_ItemID;u(N,o)}return c.join("")};GetReversedSharedWithUsers=function(c){for(var b=[],d=c.length,a=0;a<d;a++)b.unshift(c[a]);return b};function U(d,a,e){var c=["<span ",b("class","js-sharingHint-iconContainer "+d),'><img alt="" role="presentation" ',b("class",a),b("id",e),b("src",GetThemedImageUrl("spcommon.png")),"></img></span>"];return c.join("")}ApplySharingListStyles=function(a,d){m$.isFunction(ProcessImn)&&ProcessImn();var c=function(){if(typeof a.calloutRenderCtx!=="undefined"&&a.calloutRenderCtx!==null){var l=d?null:CalloutManager.getFromCalloutDescendant(a),c=a.calloutRenderCtx,m=c.HttpRoot,r=c.RealHttpRoot,e=c.listName,b=c.CurrentItem.ID,q=function(){u(e,b)},j=function(a){Boolean(l)&&l.close();var c=a.get_canManagePermissions(),d=a.get_anonymousEditLink(),f=a.get_anonymousViewLink(),h=companySharingLinksFlightOn?a.get_sharingLinks():null,g=new ManageLinkParams(m,e,b,d,f,c,q,r,h);DisplayManageLinkDialog(g)};if(typeof a.objectSharingInformation!=="undefined"&&a.objectSharingInformation!==null)j(a.objectSharingInformation);else{var f=new SP.ClientContext(m),n=f.get_web(),g=n,i=null,h=null;if(e.length>0){i=n.get_lists().getById(e);if(b.length>0){h=i.getItemById(b);g=h}else{h=null;g=i}}var k=SP.ObjectSharingInformation.getObjectSharingInformation(f,g,false,false,false,true,false,false,false);f.load(k,"CanManagePermissions","AnonymousEditLink","AnonymousViewLink");var o=function(){j(k)},p=function(){};f.executeQueryAsync(o,p)}}return false};m$(a).find(".js-callout-sharedWithGuestLink").click(c);m$(a).css({display:"block"});var b=window.top.g_childDialog;m$.isDefinedAndNotNull(b)&&b.autoSize()};NavigateToRootLibraryWithoutQueryString=function(){var a=ajaxNavigate.get_href(),b=a.indexOf("?");if(b>-1){a=a.substring(0,b);Nav.navigate(a)}};DisplayUnthemedSharingDialog=function(d,c,a,b){DisplaySharingDialogCore(d,c,a,null,null,null,true,b)};DisplaySharingDialog=function(d,c,a,b){DisplaySharingDialogCore(d,c,a,null,null,null,false,b)};DisplaySharingDialogCore=function(e,d,a,j,c,i,g,h,f,l){var m=x(e,d,a,j,g),k=function(b){var k=new URI(ajaxNavigate.get_href()),j=k.getQueryParameter("sharingDialogForListItemId");if(Boolean(j))NavigateToRootLibraryWithoutQueryString();else if(b===100)DisplaySharedWithDialogCore(e,d,a,null,null,c,i,g,f);else if(b===SP.UI.DialogResult.OK)u(d,a);else b===SP.UI.DialogResult.cancel&&SP.QoS.WriteUserEngagement("SharingDialogDismissClicked");Boolean(h)&&h.focus()},b={};b.LaunchedWithCallback=true;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(17)||m$.isDefinedAndNotNull(a)&&a.length>0&&(c=="0"||c=="1"&&i=="OneNote.Notebook"))b.SharingDialogWidth=595;else b.SharingDialogWidth=450;RenderSharingDialogByUrl(e,m,k,b,j,f,l)};RenderSharingDialogByUrl=function(b,d,f,a,l,c,j){if(b.charAt(0)=="/")b=e(b);if(!Boolean(d))d=b;var h=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(147)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(318);if(h){var g=b;if(typeof c!="undefined"&&Boolean(c))g=c;var i=DisplayClientSharingDialog(g,d,null,function(b,c){var a=SP.UI.DialogResult.invalid;switch(b){case SharingDialogReturnCode.Success:a=SP.UI.DialogResult.OK;break;case SharingDialogReturnCode.Error:alert(c);a=SP.UI.DialogResult.cancel}typeof f=="function"&&f(a)},true,l,c,j);if(i)return}if(!Boolean(a))a={};a.LaunchedWithCallback=true;var k={url:d,dialogReturnValueCallback:f,args:a,autoSizeStartWidth:a.SharingDialogWidth};OpenPopUpPageWithDialogOptions(k)};var ib=450,eb=300,db=350;DisplaySharedWithDialog=function(f,e,d,c,a,b){typeof DisplaySharedWithDialogCore=="function"&&DisplaySharedWithDialogCore(f,e,d,c,a,null,null,false,b)};DisplaySharedWithDialogCore=function(f,b,a,j,k,o,p,l,h){var r=!m$.isUndefinedOrNull(h),d=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(17),g=!d?document.createElement("div"):document.getElementById("SharedWithDlg");if(!d){var n=_dlgWndTop();if(Boolean(n)&&n!=window&&typeof n.EnsureScriptParams=="function"){n.EnsureScriptParams("sharing.js","DisplaySharedWithDialog",f,b,a,j,k,h);return}}if(!f.endsWith("/"))f+="/";if(m$.isUndefinedOrNull(b))b="";if(m$.isUndefinedOrNull(a))a="";if(m$.isUndefinedOrNull(j))j=false;if(m$.isUndefinedOrNull(k))k=false;if(a.length>0)typeof CalloutManager!=="undefined"&&CalloutManager!==null&&CalloutManager.closeAll();var i=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(147)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(318),q=d&&Boolean(g);if(d&&!q)DisplaySharingDialogCore(f,b,a,2,"0",null,false,null,h);else EnsureScriptFunc("SP.js","SP.ClientContext",function(){EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){var I="";if(!i)if(d)I=["<img src=",StAttrQuote("/_layouts/15/images/progress-circle-24.gif?rev=40"),'class="js-sharing-fullListDialogWaitImg" id=',StAttrQuote("sl-waitImg"+a)," onclick="+StAttrQuote("this.style.display='none'"),"/>",'<div class="js-sharing-fullListDialogStatusBar" id='+StAttrQuote("sl-StatusBar"+a)+">","</div>",'<div class="js-sharing-tabFullListDialog">',"</div>","<div id="+StAttrQuote("sl-SharedWithList"+a)+'class="js-sharing-fullListDialogCommandsLeft">','<a href="#" onclick="return false;" id=',StAttrQuote("sl-EmailLink"+a),' class="js-sharing-fullListDialogCommandEmail ms-calloutLink">',STSHtmlEncode(Strings.STS.L_SharedWithDialogEmailEveryone),"</a>",'<a href="#" target="_parent" onclick="return false;" id=',StAttrQuote("sl-AdvancedLink"+a),' class="js-sharing-fullListDialogCommandAdvanced ms-calloutLink">',STSHtmlEncode(Strings.STS.L_SharedWithDialogAdvanced),"</a>","</div>",'<div class="ms-core-form-bottomButtonBox ms-sharedWith-buttonrow">','<span class="js-sharing-fullListDialogApplyText ms-textXSmall" id=',StAttrQuote("sl-applyText"+a),"></span>","<img src=",StAttrQuote("/_layouts/15/images/loadingcirclests16.gif?rev=40"),' alt="',STSHtmlEncode(Strings.STS.L_Share_LoadingAltText),'" class="js-sharing-fullListDialogApplyWaitImg" id=',StAttrQuote("sl-applyWaitImg"+a)," onclick="+StAttrQuote("this.style.display='none'"),"/>","<button id=",StAttrQuote("sl-OKButton"+a),' class="js-sharing-fullListDialogCommandApply" disabled="disabled" onclick="return false;">',STSHtmlEncode(Strings.STS.L_SharedWithDialogApply),"</button>",'<button onclick="DismissTopDlgAndLog(0);" id="sl-CloseBtn'+a+'" class="js-sharing-fullListDialogCommandClose">'+STSHtmlEncode(Strings.STS.L_CloseButtonCaption)+"</button>","</div>"].join("");else I=["<img src=",StAttrQuote("/_layouts/15/images/progress-circle-24.gif?rev=40"),'class="js-sharing-fullListDialogWaitImg" id=',StAttrQuote("sl-waitImg"+a)," onclick="+StAttrQuote("this.style.display='none'"),"/>",'<div class="js-sharing-fullListDialogStatusBar" id='+StAttrQuote("sl-StatusBar"+a)+">","</div>",'<div class="js-sharing-fullListDialogCommandsTop">','<span class="js-sharing-fullListDialogManageGuestLinks ms-textSmall ms-soften">','<span class="js-sharingHint-iconContainer ms-verticalAlignMiddle">','<img class="js-sharingHint-sharedAnonymously" alt="" role="presentation"'," src=",StAttrQuote(Boolean(l)?"/_layouts/15/images/spcommon.png?rev=40":GetThemedImageUrl("spcommon.png")),"></img>","</span>",StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGuest),"<a id="+StAttrQuote("sl-ManageGuestLinks"+a)+' href="#" onclick="return false;">',"</a>"),"</span>","</div>",'<div class="js-sharing-fullListDialog">',"</div>",'<div class="js-sharing-fullListDialogCommandsLeft">','<a href="#" onclick="return false;" id=',StAttrQuote("sl-InviteLink"+a),' class="js-sharing-fullListDialogCommandInvite ms-calloutLink">',STSHtmlEncode(Strings.STS.L_SharedWithDialogInvitePeople),"</a>",'<a href="#" onclick="return false;" id=',StAttrQuote("sl-EmailLink"+a),' class="js-sharing-fullListDialogCommandEmail ms-calloutLink">',STSHtmlEncode(Strings.STS.L_SharedWithDialogEmailEveryone),"</a>",'<a href="#" onclick="return false;" id=',StAttrQuote("sl-AdvancedLink"+a),' class="js-sharing-fullListDialogCommandAdvanced ms-calloutLink">',STSHtmlEncode(Strings.STS.L_SharedWithDialogAdvanced),"</a>","</div>",'<div class="js-sharing-fullListDialogCommandsRight">','<span class="js-sharing-fullListDialogApplyText ms-textXSmall" id=',StAttrQuote("sl-applyText"+a),"></span>","<img src=",StAttrQuote("/_layouts/15/images/loadingcirclests16.gif?rev=40"),' class="js-sharing-fullListDialogApplyWaitImg" id=',StAttrQuote("sl-applyWaitImg"+a)," onclick="+StAttrQuote("this.style.display='none'"),"/>","<button id=",StAttrQuote("sl-OKButton"+a),' class="js-sharing-fullListDialogCommandApply" disabled="disabled">',STSHtmlEncode(Strings.STS.L_SharedWithDialogApply),"</button>","<button id=",StAttrQuote("sl-CloseBtn"+a),' class="js-sharing-fullListDialogCommandCancel">',STSHtmlEncode(Strings.STS.L_SharedWithDialogCancel),"</button>","</div>"].join("");else{var rb='{%version 2.0}                                <img src="{=loadingCircleImage}" alt="{=/Strings/STS/L_Share_LoadingAltText}" class="js-sharing-fullListDialogWaitImg" id="sl-waitImg{=sharedlistItemId}" onclick="this.style.display=\'none\';" />                                <div class="js-sharing-fullListDialogStatusBar" id="sl-StatusBar{=sharedlistItemId}"></div>                                <div class="js-sharing-fullListDialogCommandsTop {=hideTopCommandsClass}">                                    <span class="js-sharing-fullListDialogManageGuestLinks ms-textSmall ms-soften">                                        <span class="js-sharingHint-iconContainer ms-verticalAlignMiddle">                                            <img class="js-sharingHint-sharedAnonymously" alt="" role="presentation" src="{=sharingHintClusterImgSrc}"></img>                                        </span>                                        {=manageLinksHtml}                                    </span>                                </div>                                <div class="{=fldSharingEntriesClass}"></div>                                <div id="sl-SharedWithList{=sharedlistItemId}" class="js-sharing-fullListDialogCommandsLeft">                                    <a href="#" onclick="return false;" id="sl-InviteLink{=sharedlistItemId}" class="js-sharing-fullListDialogCommandInvite ms-calloutLink {=hideInviteLinkClass}">{=/Strings/STS/L_SharedWithDialogInvitePeople}</a>                                    <a href="#" onclick="return false;" id="sl-StopSharingLink{=sharedlistItemId}" class="js-sharing-fullListDialogCommandStopSharing ms-calloutLink">{=/Strings/STS/L_StopSharing}</a>                                    <a href="#" onclick="return false;" id="sl-EmailLink{=sharedlistItemId}" class="js-sharing-fullListDialogCommandEmail ms-calloutLink">{=/Strings/STS/L_SharedWithDialogEmailEveryone}</a>                                    <a href="#" onclick="return false;" id="sl-AdvancedLink{=sharedlistItemId}" class="js-sharing-fullListDialogCommandAdvanced ms-calloutLink" target="_parent">{=/Strings/STS/L_SharedWithDialogAdvanced}</a>                                </div>                                <div class="js-sharing-fullListDialogCommandsRight">                                    <span class="js-sharing-fullListDialogApplyText ms-textXSmall" id="sl-applyText{=sharedlistItemId}"></span>                                    <img src="{=loadingCircleImageSmall}" alt="{=/Strings/STS/L_Share_LoadingAltText}" class="js-sharing-fullListDialogApplyWaitImg" id="sl-applyWaitImg{=sharedlistItemId}" onclick="this.style.display=\'none\';" />                                    <button id="sl-OKButton{=sharedlistItemId}" class="js-sharing-fullListDialogCommandApply" disabled="disabled">{=/Strings/STS/L_SharedWithDialogApply}</button>                                    <button id="sl-CloseBtn{=sharedlistItemId}" class="js-sharing-fullListDialogCommandCancel" onclick="DismissTopDlgAndLog(0);">{=/Strings/STS/L_SharedWithDialogCancel}</button>                                </div>',wb={loadingCircleImage:"/_layouts/15/images/progress-circle-24.gif?rev=40",loadingCircleImageSmall:"/_layouts/15/images/loadingcirclests16.gif?rev=40",sharedlistItemId:a,fldSharingEntriesClass:d?"js-sharing-tabFullListDialog":"js-sharing-fullListDialog",hideTopCommandsClass:d?"ms-hide":"",hideInviteLinkClass:d?"ms-hide":"",sharingHintClusterImgSrc:Boolean(l)?"/_layouts/15/images/spcommon.png?rev=40":GetThemedImageUrl("spcommon.png"),manageLinksHtml:StBuildParam(Encoding.HtmlEncode(Strings.STS.L_SharedWithGuest),'<a id="sl-ManageGuestLinks'+a+'" href="#" onclick="return false;">',"</a>")},jb=new Renderer;jb.SetTemplate("main",rb);I=jb.Render("main",wb)}g.innerHTML=I;m$(g).click(MenuHtc_hide);m$(g).find(".js-sharing-fullListDialog").scroll(MenuHtc_hide);if(!d){DismissTopDlg(0);var J=null,ub={html:g,title:Strings.STS.L_SharedWithDialogTitle,allowMaximize:false,includeScrollBarPadding:false,autoSizeStartWidth:ib};g.className="js-sharing-fullListDialogContainer";g.id="sl-Container"+a;J=SP.UI.ModalDialog.showModalDialog(ub)}c();var Q=document.getElementById("sl-waitImg"+a),A=document.getElementById("sl-applyText"+a),y=document.getElementById("sl-applyWaitImg"+a),v=document.getElementById("sl-InviteLink"+a),ob=document.getElementById("sl-StopSharingLink"+a),E=document.getElementById("sl-EmailLink"+a),fb=document.getElementById("sl-AdvancedLink"+a),x=document.getElementById("sl-OKButton"+a),O=document.getElementById("sl-CloseBtn"+a),Z=document.getElementById("sl-ManageGuestLinks"+a),w=m$(g).find(".js-sharing-tabFullListDialog")[0],z=[],G=true,H=false,C="",D="",N="",hb=null,cb=new tb(ob,f,b,a);if(!d){w=m$(g).find(".js-sharing-fullListDialog")[0];m$(v).click(function(){SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.OK,null);var c=typeof window.top.g_childDialog!="undefined"?window.top.g_childDialog:undefined;Boolean(c)&&c.close(SP.UI.DialogResult.cancel);DisplaySharingDialogCore(f,b,a,0,o,p,l,null,h);return false});m$(O).click(function(){SP.QoS.WriteUserEngagement("SharingSharedWithTabCloseClicked");SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.OK,null)});O.focus()}m$(fb).click(function(){SP.QoS.WriteUserEngagement("SharingSharedWithAdvancedClick");var e=[f,"_layouts/15/User.aspx","?"];if(m$.isDefinedAndNotNull(b)&&b.length>0){e.push("List=",escapeProperly(b));m$.isDefinedAndNotNull(a)&&a.length>0&&e.push("&obj=",b,",",a,",LISTITEM")}var c=e.join("");c=AddSourceToUrl(c);if(d)window.parent.location.href=c;else Nav.navigate(c);return false});m$(x).click(function(){if(m$.isDefinedAndNotNull(y))y.style.display="inline";if(i&&d)sb();else vb()});if(b.length>0)b=unescapeProperly(b);var L=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(194);if(!i||!d){var r=new SP.ClientContext(f),B=r.get_web(),P=B,s=null,q=null,F=null;if(b.length>0){s=B.get_lists().getById(b);if(a.length>0){q=s.getItemById(a);P=q}else{q=null;P=s}}else{s=null;q=null}r.load(B,"Title","ServerRelativeUrl");if(m$.isDefinedAndNotNull(s)){r.load(s,"BaseType","Title");F=s.get_rootFolder();m$.isDefinedAndNotNull(F)&&r.load(F,"ServerRelativeUrl")}m$.isDefinedAndNotNull(q)&&r.load(q,"ID","FileRef","FileLeafRef","FSObjType","Client_Title");var t=SP.ObjectSharingInformation.getObjectSharingInformation(r,P,false,false,false,true,true,true,!j),gb=t.getSharedWithUsers(r),W=[t,"IsSharedWithGuest","CanManagePermissions","AnonymousEditLink","AnonymousViewLink","HasPendingAccessRequests","PendingAccessRequestsLink","HasPermissionLevels"];L&&W.push("CanBeShared");r.load.apply(r,W);r.load(gb)}var S=function(){var n=t.get_isSharedWithGuest(),i=t.get_hasPendingAccessRequests();H=t.get_canManagePermissions();C=t.get_anonymousEditLink();D=t.get_anonymousViewLink();var e=t.get_hasPermissionLevels(),j=L?t.get_canBeShared():true,g=gb.getEnumerator(),h=0;!j&&Boolean(v)&&v.parentNode.removeChild(v);while(g.moveNext()){var a=g.get_current(),f=a.get_id(),B=a.get_name(),c=a.get_email(),y=a.get_picture(),A=a.get_jobTitle(),x=a.get_department(),E=a.get_sipAddress(),p=a.get_customRoleNames(),l=a.get_hasEditPermission(),m=a.get_hasViewPermission(),u=a.get_isSiteAdmin(),s=a.get_isDomainGroup(),k=V({id:f,title:B,email:c,pictureURL:y,sip:E,jobTitle:A,department:x,isDomainGrop:s},e),o=e?Y(f,a,u,p,l,m):null,q=ab(k,o,f);w.appendChild(q);m$.isDefinedAndNotNull(c)&&c.length>0&&z.push(escapeProperly(c));h++}var r=30;if(h>=r){var b=document.createElement("DIV");b.className="js-sharing-fullListDialogEntry js-sharing-fullListDialogEntrySharedWithMany ms-soften";b.id="sharingListEntry_many";b.innerHTML=STSHtmlEncode(Strings.STS.L_SharedWithDialogManyMessage);w.appendChild(b);G=false}if(i){N=t.get_pendingAccessRequestsLink();R()}n&&(Boolean(C)||Boolean(D))&&!d&&U();X(!e)},T=function(d,b){if(m$.isDefinedAndNotNull(w)){var a=document.createElement("SPAN");a.innerHTML=b.get_message();w.appendChild(a);Q.style.display="none";c()}},kb=function(J,b){var p=b.IsSharedWithGuest,k=b.HasPendingAccessRequests;hb=companySharingLinksFlightOn?b.SharingLinks:null;H=b.CanManagePermissions;C=b.AnonymousEditLink;D=b.AnonymousViewLink;var f=b.HasPermissionLevels,l=L?b.CanBeShared:true,i=b.SharedWithUsersCollection.results,j=0;cb.Initialize(b);!l&&Boolean(v)&&v.parentNode.removeChild(v);for(var h=0,F=i.length;h<F;h++){var a=i[h],g=a.Id,E=a.Name,e=a.Email,A=a.Picture,B=a.JobTitle,y=a.Department,I=a.SipAddress,r=a.CustomRoleNames,n=a.HasEditPermission,o=a.HasViewPermission,x=a.IsSiteAdmin,u=a.IsDomainGroup,m=V({id:g,title:E,email:e,pictureURL:A,sip:I,jobTitle:B,department:y,isDomainGroup:u},f),q=f?Y(g,a,x,r,n,o):null,s=ab(m,q,g);w.appendChild(s);m$.isDefinedAndNotNull(e)&&e.length>0&&z.push(escapeProperly(e));j++}var t=30;if(j>=t){var c=document.createElement("DIV");c.className="js-sharing-fullListDialogEntry js-sharing-fullListDialogEntrySharedWithMany ms-soften";c.id="sharingListEntry_many";c.innerHTML=STSHtmlEncode(Strings.STS.L_SharedWithDialogManyMessage);w.appendChild(c);G=false}if(k){N=b.PendingAccessRequestsLink;R()}p&&(Boolean(C)||Boolean(D))&&!d&&U();X(!f)},lb=function(d,b){if(Boolean(w)){var a=document.createElement("SPAN");a.innerHTML=b;w.appendChild(a);Q.style.display="none";c()}},bb=function(k,g){if(!i||!d)r.executeQueryAsync(k,g);else{var c,e=f;if(Boolean(h)){e=h;c="_api/SP.RemoteWeb(@url)";if(Boolean(b))c+="/GetListById(listGuid='"+b+"')";if(Boolean(a))c+="/GetItemById(id='"+a+"')";c+="?@url='"+f+"'"}else{c="_api/web";if(Boolean(b))c+="/Lists/GetById(id='"+b+"')";if(Boolean(a))c+="/GetItemById(id='"+a+"')"}GetObjectSharingInformation(kb,lb,e,c,false,false,false,true,true,true,!j)}};if(typeof SP!="undefined"&&typeof SP.QoS!="undefined")SP.QoS.ExecuteMonitoredAsync("SharingSharedWithTabRender","SharingSharedWithTabRenderStart","SharingSharedWithTabRenderSuccess","SharingSharedWithTabRenderFailure","SharingSharedWithTabRenderNoResult",bb,S,T);else bb(S,T);var R=function(){var d=[STSHtmlEncode(Strings.STS.L_SharedWithDialogPendingAccessRequests)," <a href=",StAttrQuote(N)," onclick=\"if (typeof(NavigateParentOrSelf) !== 'undefined') { NavigateParentOrSelf(this, this.href); return false; }\"",' target="_top">',STSHtmlEncode(Strings.STS.L_SharedWithDialogViewAccessRequests),"</a>"].join(""),e=_createStatusMarkup("",d,false),b=document.createElement("SPAN");b.className=StatusBarClassNames[StatusPriority.yellow]+" ms-status-msg";b.style.display="block";b.appendChild(e);var c=document.getElementById("sl-StatusBar"+a);c.appendChild(b);c.style.display="block"},U=function(){Z.parentNode.style.display="inline-block";m$(Z).click(function(){Boolean(J)&&J.close();var c=new ManageLinkParams(f,b,a,C,D,H,null,h,hb);DisplayManageLinkDialog(c,l);return false})},X=function(a){if(!d&&!k&&(m$.isUndefinedOrNull(s)||m$.isUndefinedOrNull(q)||m$.isDefinedAndNotNull(q)&&s.get_baseType()==1))v.style.display="inline";else if(!d)v.style.display="none";cb.ShowLinkIfNeeded();if(i&&d)pb();else qb();if(a)x.style.visibility="hidden";else{x.style.visibility="visible";x.disabled=true}if(!a||H)fb.style.display="inline";O.style.visibility="visible";Q.style.display="none";window.setTimeout(function(){m$.isFunction(ProcessImn)&&ProcessImn();Accessibility.FocusFirstTabStop(document.getElementById("SharedWithDlgCore"))},0);if(!d)J.autoSize();else m(function(){return false})},n={edit:"edit",view:"view",custom:"custom",none:"none"},vb=function(){var a=[],b=0,d=0,c=0;m$(g).find(".js-sharing-fullListDialogEntryPermissionsInnerContainer").forEach(function(e){if(e.currentSelection!==e.initialSelection){var h=e.loginName,f;switch(e.currentSelection){case n.edit:f=SP.Sharing.Role.edit;b++;break;case n.view:f=SP.Sharing.Role.view;d++;break;case n.none:f=SP.Sharing.Role.none;c++;break;default:return}}e.initialSelection=e.currentSelection;if(e.currentSelection!==n.custom)e.actualPermission=null;var g=new SP.Sharing.UserRoleAssignment;g.set_userId(h);g.set_role(f);a.push(g)});a.length>0&&nb(a,b,d,c,function(){x.disabled=true})},qb=function(){if(z.length>0&&G){var a=null,b=null;if(m$.isDefinedAndNotNull(q))if(s.get_baseType()==1||q.get_item("FSObjType")==="1"){a=q.get_item("FileLeafRef");b=getHostUrl(f)+encodeURI(q.get_item("FileRef"))}else a=q.get_client_Title();else if(m$.isDefinedAndNotNull(s)){a=s.get_title();if(m$.isDefinedAndNotNull(F))b=getHostUrl(ajaxNavigate.get_href())+F.get_serverRelativeUrl()}else if(m$.isDefinedAndNotNull(B)){a=B.get_title();b=getHostUrl(ajaxNavigate.get_href())+B.get_serverRelativeUrl()}ConfigEmailLinkHelper(z,E,a,b)}},nb=function(a,b,d,c,e){var g=function(b,c){var d=getHostUrl(f)+q.get_item("FileRef");SP.Sharing.DocumentSharingManager.updateDocumentSharingInfo(r,d,a,false,false,false,null,false,false);r.executeQueryAsync(function(){b(e)},c)};SP.QoS.ExecuteMonitoredAsync("SharingSharedWithSave","SharingSharedWithSaveStart","SharingSharedWithSaveSuccess","SharingSharedWithSaveFailure","SharingSharedWithSaveNoResult",g,K,M,{EditChanges:b,ViewChanges:d,NoneChanges:c})},pb=function(){if(z.length>0&&G){E.style.display="inline";var a=[];a.push("mailto:");a.push(z.join(";"));var c=L_ItemName,b=e(L_ItemUrl);(Boolean(c)||Boolean(b))&&a.push("?");var f=false;if(Boolean(c)){a.push("subject=");a.push(escapeProperly(c));f=true}if(Boolean(b)){f&&a.push("&");a.push("body=");if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(364))a.push(encodeURIComponent(b));else a.push(encodeURIComponent(encodeURI(b)))}var d=function(){typeof SP!="undefined"&&typeof SP.QoS!="undefined"&&SP.QoS.WriteUserEngagement("SharingSharedWithEmailEveryoneClick");window.location.href=a.join("");return false};if(Boolean(E.addEventListener))E.addEventListener("click",d,false);else E.attachEvent("onclick",d)}},sb=function(){for(var c=[],i=0,k=0,j=0,f=g.querySelectorAll(".js-sharing-fullListDialogEntryPermissionsInnerContainer"),e=0,l=f.length;e<l;e++){var a=f[e];if(a.currentSelection!==a.initialSelection){var h=a.loginName,b;switch(a.currentSelection){case n.edit:b=SharingRole.Edit;i++;break;case n.view:b=SharingRole.View;k++;break;case n.none:b=SharingRole.None;j++;break;default:typeof Sys!="undefined";return}}a.initialSelection=a.currentSelection;if(a.currentSelection!==n.custom)a.actualPermission=null;if(Boolean(h)&&!isNaN(b)){var d={};d.UserId=h;d.Role=b;c.push(d)}}c.length>0&&mb(c,i,k,j,function(){x.disabled=true})},mb=function(b,c,g,d,h){var a=function(a,c){UpdateDocumentSharingInfo(function(){a(h)},c,f,e(L_ItemUrl),b,false,false,false,null,false,false)};if(typeof SP!="undefined"&&typeof SP.QoS!="undefined")SP.QoS.ExecuteMonitoredAsync("SharingSharedWithSave","SharingSharedWithSaveStart","SharingSharedWithSaveSuccess","SharingSharedWithSaveFailure","SharingSharedWithSaveNoResult",a,K,M,{EditChanges:c,ViewChanges:g,NoneChanges:d});else a(K,M)},K=function(c){if(m$.isDefinedAndNotNull(y)){y.style.display="none";!A.hasChildNodes()&&A.appendChild(document.createTextNode(Strings.STS.L_SharedWithDialogApplySuccessText));A.style.display="inline";A.style.opacity=1;var d=function(){SPAnimationUtility.BasicAnimator.FadeOut(A,function(){A.style.display="none";y.style.display="none"})};window.setTimeout(d,500)}u(b,a);m$.isDefinedAndNotNull(c)&&c()},M=function(){if(m$.isDefinedAndNotNull(y))y.style.display="none";alert(Strings.STS.L_SharedWithDialogApplyUpdatedPermissionsFailed)},V=function(b,e){var c=document.createElement("div");c.className="js-sharing-fullListDialogEntryNameAndTitleContainer";var d=new ContextInfo;d.Templates={};d.Templates.Fields={};var g={Field:[{Name:"SharedWith",FieldType:"User",RealFieldName:"SharedWith",WithPicture:"1",PictureSize:"Size_48px",WithPictureDetail:"1",HasUserLink:"1",Type:"User",MaxWidth:e?eb:db}],EffectivePresenceEnabled:"1",PresenceAlt:Strings.STS.L_UserFieldNoUserPresenceAlt,UserDispUrl:f+"_layouts/15/userdisp.aspx"},h={ID:a,SharedWith:[{id:b.id,title:b.title,email:b.email,picture:b.pictureURL,sip:b.sip,jobTitle:b.jobTitle,department:b.department}]},i=spMgr.RenderFieldByName(d,"SharedWith",h,g);c.innerHTML=i;return c},Y=function(g,c,h,e,i,j){var f=document.createElement("div");f.className="js-sharing-fullListDialogEntryPermissionsContainer";var k=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(496)&&c.IsMemberOfGroup,a,b;if(h)a=document.createElement("span");else{a=document.createElement("a");a.href="#";a.onclick=function(){return false}}a.className="js-sharing-fullListDialogEntryPermissionsInnerContainer";a.id="sl-permissionsMenuElement"+g;f.appendChild(a);if(h)a.innerHTML=STSHtmlEncode(Strings.STS.L_SharedWithDialogOwnerPermission);else if(k){m$(a).addClass("js-sharing-fullListDialogEntryPermissionsMenu");b=document.createElement("span");m$(b).addClass("js-sharing-fullListDialogEntryPermissionsText");a.appendChild(b);if(isDefinedAndNotNullOrEmpty(e))b.innerHTML=STSHtmlEncode(e);else if(i)b.innerHTML=STSHtmlEncode(Strings.STS.L_EditPermission);else if(j)b.innerHTML=STSHtmlEncode(Strings.STS.L_ViewPermission);m$(a).click(function(f){var b=m$(f.target).closest(".js-sharing-fullListDialogEntryPermissionsMenu")[0],d="sl-permissionsMenu"+g,e=CMenu(d);CAMOpt(e,"Check permissions for "+c.Name,'CheckPermissionsFor("'+c.Name+'");');var a=document.createElement("span");a.id=d;a.style.position="absolute";b.appendChild(a);var i=m$(b).offset().left,h=m$(b).offset().bottom;m$(a).offset({left:i,top:h});MenuHtc_hide();OMenu(e,a,undefined,false);f.stopPropagation();return false})}else{m$(a).addClass("js-sharing-fullListDialogEntryPermissionsMenu");b=document.createElement("span");m$(b).addClass("js-sharing-fullListDialogEntryPermissionsText");a.appendChild(b);var d=document.createElement("img");m$(d).addClass("js-sharing-fullListDialogEntryPermissionsMenuArrow");d.src="/_layouts/15/images/ecbarw.png?rev=40";d.alt=Strings.STS.L_OpenMenu_Text;a.appendChild(d);m$(a).click(function(i){var a=m$(i.target).closest(".js-sharing-fullListDialogEntryPermissionsMenu")[0],f="sl-permissionsMenu"+g,h=CMenu(f),c=function(c){var b="";switch(c){case n.edit:b=Strings.STS.L_EditPermission;break;case n.view:b=Strings.STS.L_ViewPermission;break;case n.custom:b=a.actualPermission;break;case n.none:b=Strings.STS.L_StopSharing}CAMOpt(h,b,'SetSelectedPermission("'+c+'", "'+a.id+'");')};c(n.edit);c(n.view);isDefinedAndNotNullOrEmpty(a.actualPermission)&&c(n.custom);c(n.none);var b=document.createElement("span");b.id=f;b.style.position="absolute";a.appendChild(b);var e=m$(a).offset().left;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(17)){if(window.document.documentElement.getAttribute("dir")==="ltr")e=e+65;d=d+3}var d=m$(a).offset().bottom;m$(b).offset({left:e,top:d});MenuHtc_hide();OMenu(h,b,undefined,false);i.stopPropagation();return false});if(isDefinedAndNotNullOrEmpty(e)){a.initialSelection=n.custom;a.actualPermission=e}else if(i)a.initialSelection=n.edit;else if(j)a.initialSelection=n.view;a.loginName=Boolean(c.LoginName)?c.LoginName:c.get_loginName();SetSelectedPermission(a.initialSelection,a)}return f};SetSelectedPermission=function(c,a){if(!m$.isElement(a))a=document.getElementById(a);if(a.currentSelection!==c){var b="";switch(c){case n.edit:b=Strings.STS.L_EditPermission;break;case n.view:b=Strings.STS.L_ViewPermission;break;case n.custom:b=a.actualPermission;break;case n.none:b=Strings.STS.L_StopSharing}m$(a).find(".js-sharing-fullListDialogEntryPermissionsText")[0].innerHTML=STSHtmlEncode(b);a.currentSelection=c;x.disabled=false}a.focus()};CheckPermissionsFor=function(d){var c="?obj="+b+","+a+"&users="+d+"&IsDlg=1",e=GetLayoutsPageUrl(f,"chkperm.aspx",c);OpenPopUpPage(e,null,null,null)};var ab=function(d,b,c){var a=document.createElement("div");a.className="js-sharing-fullListDialogEntry";if(m$.isDefinedAndNotNull(c))a.id="sharingListEntry_"+c;a.appendChild(d);m$.isDefinedAndNotNull(b)&&a.appendChild(b);return a}})})};ConfigEmailLinkHelper=function(f,d,c,b){if(f.length>0){d.style.display="inline";var a=[];a.push("mailto:");a.push(f.join(";"));(m$.isDefinedAndNotNull(c)||m$.isDefinedAndNotNull(b))&&a.push("?");var g=false;if(m$.isDefinedAndNotNull(c)){a.push("subject=");a.push(escapeProperly(c));g=true}if(m$.isDefinedAndNotNull(b)){g&&a.push("&");a.push("body=");a.push(encodeURIComponent(e(b)))}m$(d).click(function(){window.location.href=a.join("");return false})}};var zb='<div class="ms-table ms-manageLink-table">',G=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(40),w="",Y=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_Disablelink);if(!G)w='<div class="ms-tableRow ms-manageLink-url-div">                            <div class="ms-tableCell">                              <input type="text" oncopy="OnCopyLink(\'{0}\');" class="ms-manageLink-url ms-noWrap ms-manageLink-tabbed-url-width" value="{1}" title="{2}" readonly="readonly" onmousedown="SelectOnFocus(this, event);"/>                            </div>                            <div class="ms-tableCell ms-manageLink-disable" style="{3}">                              <a id="{4}" href="#" class="ms-heroCommandLink ms-commandLink" onclick="OnDisableLink({5}, this, GetManageLinkParams());return false;">'+Y+"</a>                            </div>                          </div>";else{var Gb=GenQrImgLink("{1}","vertical-align:middle;");w='<div class="ms-tableRow ms-manageLink-url-div">                            <div class="ms-tableCell">                              <input type="text" oncopy="OnCopyLink(\'{0}\');" class="ms-manageLink-url ms-noWrap ms-manageLink-tabbed-url-width" value="{1}" title="{2}" readonly="readonly" onmousedown="SelectOnFocus(this, event);"/>                            '+Gb+'                            </div>                            <div class="ms-tableCell ms-manageLink-disable" style="{3}">                              <a id="{4}" href="#" class="ms-heroCommandLink ms-commandLink" onclick="OnDisableLink({5}, this, GetManageLinkParams());return false;">'+Y+"</a>                            </div>                          </div>"}var Z='<div style="{0}" class="ms-manageLink-create">                              <a id="{1}" href="#" class="ms-heroCommandLink ms-commandLink" onclick="OnCreateLink(GetManageLinkParams(), {2}, this);return false;">'+Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_CreateLink)+"</a>                            </div>",cb='<div class="ms-tableRow">                       <div class="ms-tableCell ms-manageLink-cell">                           <div class="ms-manageLink-column">{0}</div>                       </div>                   </div>                   <div class="ms-tableRow">                       <div class="ms-tableCell ms-manageLink-cell">                           <div class="ms-manageLink-column ms-aclinv-linksSectionPadding" id="{1}">                               {2}                                <div id="{3}" class="ms-aclinv-tabbedControlLinksSectionProgressBar ms-manageLink-progress">                                   <img class="ms-manageLink-progress-img" src="/_layouts/15/images/loadingcirclests16.gif?rev=40" onclick="this.style.display=\'none\';" alt="'+Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ProgressTooltip)+'" />                                   <span>'+Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ProgressText)+"</span>                               </div>                           </div>                       </div>                   </div>",bb="js-manageLinkUrl-",Ib="js-manageLink-deletelink-",l="js-manageLinkPrgBr-";ManageLinkParams=function(b,a,k,i,j,e,f,g,h){if(!b.endsWith("/"))b+="/";var c=a.indexOf("{"),d=a.indexOf("}");if(c>=0&&d>=0)a=a.substring(c+1,d);this.webUrl=b;this.listId=a;this.itemId=k;this.editLink=i;this.viewLink=j;this.allowDisableLink=e;this.onReturnCallback=f;this.contextWebUrl=g;this.sharingLinks=h};ManageLinkParams.prototype={webUrl:undefined,listId:undefined,itemId:undefined,editLink:undefined,viewLink:undefined,allowDisableLink:undefined,onReturnCallback:undefined,contextWebUrl:undefined,sharingLinks:undefined};function o(b){var a=document.getElementById("js-manageLink-progressText");if(Boolean(a)&&Boolean(b))a.innerHTML=Encoding.HtmlEncode(b)}function q(a){var c=document.getElementById("js-manageLink-expirationSelector");if(Boolean(c)){c.style.display=a?"none":"";var b=document.getElementById("js-manageLink-customExpirationDiv");if(Boolean(b)){b.style.display=a?"":"none";var d=document.getElementById("js-manageLink-expirationInput");Boolean(d)&&a&&d.select()}var e=document.getElementById("js-manageLink-expirationInputErrorDiv");if(Boolean(e)&&!a)b.style.display="none"}}function k(c,b){var a=c;while(a.length<b)a="0"+a;return a}function pb(d){var f=null,b=SharingLinkExpirationValues[Encoding.HtmlDecode(d)];if(isNaN(b)){var g=24*60,c=parseInt(d);if(!isNaN(c)&&c>0)b=c*g;else b=null}if(b!=null){var a=new Date;a.setMinutes(a.getMinutes()+b);var o=a.getFullYear().toString(),n=k((a.getMonth()+1).toString(),2),p=k(a.getDate().toString(),2),m=k(a.getHours().toString(),2),j=k(a.getMinutes().toString(),2),l=k(a.getSeconds().toString(),2),e=a.getTimezoneOffset()<0?true:false,i=k(e?Math.ceil(a.getTimezoneOffset()/60).toString().replace("-",""):Math.floor(a.getTimezoneOffset()/60).toString(),2),h=k((a.getTimezoneOffset()%60).toString().replace("-",""),2);f=o+n+p+"T"+m+j+l+(e?"-":"+")+i+h}return f}function Q(e,f){var a="";if(!Boolean(L_SharingLinkProperties))return"";var c=L_SharingLinkProperties[e];if(Boolean(c)){var b=expiryFlightOn&&c.SupportsExpiration,d=b?GenerateExpiryTextHTML(f):"";a=b?Boolean(d)?Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_UpdateSharingLinkExpiration):Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_SetSharingLinkExpiration):""}return a}function B(g,f){var b=document.getElementById("js-manageLink-linkExpirationDate"),e=document.getElementById("js-manageLink-linkExpirationLabel"),d=document.getElementById("js-manageLink-expirationSelector"),a=Q(g,f);if(Boolean(d)&&Boolean(b)&&Boolean(e)){var c="";if(Boolean(a))c=GenerateExpiryTextHTML(f);b.style.display=Boolean(c)?"":"none";b.innerHTML=c;if(a!=null)e.innerHTML=Encoding.HtmlEncode(a);d.style.display=Boolean(a)?"":"none"}}function yb(f){if(!Boolean(L_SharingLinkProperties))return null;for(var b=f.sharingLinks,d=-1,e=SharingLinkKind.Uninitialized,a=0,g=b.length;a<g;a++){var c=L_SharingLinkProperties[b[a].LinkKind];if(b[a].IsActive&&c.Priority>d){e=b[a].LinkKind;d=c.Priority}}return e}function A(e,c){var a=e.sharingLinks;if(!Boolean(a)||isNaN(c)||c<0)return null;for(var d=0,f=a.length;d<f;d++){var b=a[d];if(b.LinkKind==c&&b.IsActive)return b.Url}return null}function j(f,b,c){if(isNaN(b)||b<0)return;var a=f.sharingLinks;if(!Boolean(a))a=[];for(var g=false,e=0,i=a.length;e<i;e++){var d=a[e];if(d.LinkKind==b){d.Url=c;d.IsActive=Boolean(c);g=true}}if(!g){var h={LinkKind:b,Url:c,IsActive:Boolean(c)};a.push(h)}L_SharingLinks=f.sharingLinks}function M(e){var a=e.sharingLinks,g=SharingLinkKind.OrganizationEdit,c=document.getElementById("js-manageLink-linkTypeText");if(Boolean(c)&&Boolean(a)&&a.length>0)for(var b=0,f=a.length;b<f;b++)if(a[b].LinkKind==L_SelectedSharingLinkKind){var d=Encoding.HtmlEncode(a[b].LinkLabel);c.innerHTML=d;c.title=d}}function d(a){var i=document.getElementById("js-manageLink-linkTypeDropdown"),e=document.getElementById("js-manageLink-linkBox"),h=document.getElementById("js-manageLink-additionalHtmlDiv"),j=document.getElementById("CopySharingLinkBtn"),f=document.getElementById("idDisableSharingLnk"),c=document.getElementById("js-manageLink-linkExpirationDropdown"),d=document.getElementById("js-manageLink-expirationSave"),b=document.getElementById("js-manageLink-expirationCancel");if(Boolean(e))if(a)e.setAttribute("disabled","disabled");else{var g=A(GetManageLinkParams(),L_SelectedSharingLinkKind);e.value=g;e.title=g;e.removeAttribute("disabled")}if(Boolean(i))if(a)CSSUtil.AddClass(i,"ms-commandLinkDisabled");else CSSUtil.RemoveClass(i,"ms-commandLinkDisabled");if(Boolean(j))if(a)j.setAttribute("disabled","disabled");else j.removeAttribute("disabled");if(Boolean(f))if(a||L_SelectedSharingLinkKind==SharingLinkKind.Direct){f.setAttribute("disabled","disabled");CSSUtil.AddClass(f,"ms-commandLinkDisabled")}else{f.removeAttribute("disabled");CSSUtil.RemoveClass(f,"ms-commandLinkDisabled")}if(Boolean(c))if(a){c.setAttribute("disabled","true");CSSUtil.AddClass(c,"ms-commandLinkDisabled")}else{c.removeAttribute("disabled");CSSUtil.RemoveClass(c,"ms-commandLinkDisabled")}if(Boolean(d))if(a){d.setAttribute("disabled","disabled");CSSUtil.AddClass(d,"ms-commandLinkDisabled")}else{d.removeAttribute("disabled");CSSUtil.RemoveClass(d,"ms-commandLinkDisabled")}if(Boolean(b))if(a){b.setAttribute("disabled","disabled");CSSUtil.AddClass(b,"ms-commandLinkDisabled")}else{b.removeAttribute("disabled");CSSUtil.RemoveClass(b,"ms-commandLinkDisabled")}if(expiryFlightOn&&!a){(L_SelectedSharingLinkKind==SharingLinkKind.OrganizationEdit||L_SelectedSharingLinkKind==SharingLinkKind.OrganizationView)&&q(false);B(L_SelectedSharingLinkKind,g)}if(Boolean(h))if(a)for(var l=h.getElementsByTagName("A"),k=0,m=l.length;k<m;k++)l[k].removeAttribute("onclick");else if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(40))h.innerHTML=GenQrImgLink(g,"vertical-align:middle;");rb("js-manageLink-sharingProgressDiv",a)}function lb(){var a=SuiteNavCommon.ExtractSuiteProperty(OpenSuiteLinksJson(),"CompanyDisplayName");return Boolean(a)?a:null}function qb(a){var bb='{%version 2.0}             <div class="ms-manageLink-table">                 <div class="{=DialogContentDivClass}" id="dialogContent">                     {%templateSelect SharingLinksTemplate}                     {%foreach ManagedLinkRow LinksMetadata}                 </div>                 <div class="ms-core-form-bottomButtonBox">                     <input class="ms-ButtonHeightWidth" type="button" id="CloseBtn" onclick="{+onClickGetLinksDialogClose}; return false;" value="{=/Strings/STS/L_Sharing_ManageLink_CloseButton}" />                 </div>             </div>',U='{%version 2.0}             <div class="ms-aclinv-linksSectionPadding ms-manageLink-sharingLinkSelector">                 <div class="ms-table ms-manageLink-column ms-fullWidth">                     {%templateSelect SharingLinksMetadata/LinkTypeTemplate SharingLinksMetadata}                     {%template LinkBox SharingLinksMetadata}                     {%template LinkExpirationSelector SharingLinksMetadata}                     <div class="ms-tableRow ms-fullWidth">                         <div id="js-manageLink-sharingProgressDiv" class="ms-tableCell ms-aclinv-tabbedControlLinksSectionProgressBar ms-manageLink-progress">                             <img class="ms-manageLink-progress-img" src="{=SharingLinksMetadata/LoadingImageSrc}" onclick="this.style.display=\'none\';" alt="{=/Strings/STS/L_SPClientPeoplePickerWaitImgAlt}" />                             <span id="js-manageLink-progressText"></span>                         </div>                     </div>                 </div>             </div>',W='{%version 2.0} <span class="ms-metadata ms-manageLink-singleLinkLabel">{=SharingLinkTypeText}</span>',X='{%version 2.0}             <div class="ms-tableRow">                 <div class="ms-tableCell ms-manageLink-cell">                     <div class="ms-manageLink-column">{=ManageLinkLabelText}</div>                 </div>             </div>',kb="{%version 2.0}",Y='{%version 2.0}             {%templateSelect LinkLabelTemplate}             <div class="ms-tableRow">                 <div class="ms-tableCell ms-manageLink-cell">                     <div class="ms-manageLink-column ms-aclinv-linksSectionPadding" id="{=ManageLinkUrlDivId}">                         {%templateSelect LinkTypeDescriptionTemplate}                         {%templateSelect GuestLinkTemplate}                         <div id="{=ManageLinkProgressBarDivId}" class="ms-aclinv-tabbedControlLinksSectionProgressBar ms-manageLink-progress">                             <img class="ms-manageLink-progress-img" src="{=LoadingImageSrc}" onclick="this.style.display=\'none\';" alt="{=/Strings/STS/L_Sharing_ManageLink_ProgressTooltip}" />                             <span>{=CreateLinkProgressText}</span>                         </div>                     </div>                 </div>             </div>',ab='{%version 2.0}             <div style="{=ManageLinkStyle}" class="ms-manageLink-create">                 <a id="{=AddLinkId}" title="{=LinkTitleText}" href="javascript:;" class="ms-heroCommandLink ms-commandLink ms-anonymousLinkExpiration-addExternalLink" onclick="OnCreateLink(GetManageLinkParams(), {=IsEditLink}, this);return false;">                 {=AddOrCreateLinkText}</a>            </div>',cb='{%version 2.0}             <div class="ms-table ms-fullWidth">                 <div class="ms-tableRow ms-fullWidth">                     <div class="ms-tableCell ms-fullWidth ms-manageLink-url-div">                         <input type="text" oncopy="OnCopyLink(\'{=CopyTag}\');" class="ms-manageLink-url ms-noWrap ms-fullWidth {=ManageLinkUrlClass}" id="{=ManageLinkUrlId}" value="{=LinkUrl}" title="{=LinkUrl}" readonly="readonly" onmousedown="SelectOnFocus(this, event);"/>                     </div>                     <div class="ms-tableCell" id="js-manageLink-additionalHtmlDiv">                         {=AdditionalHtml}                     </div>                     <div id="js-manageLink-CopyButtonDiv" class="ms-tableCell {=CopyButtonVisibilityClass}">                         <input class="ms-button-emphasize ms-ButtonHeightWidth ms-manageLink-copyButton" type="button" id="CopySharingLinkBtn" onclick="{+onClickCopySharingLink}; return false;" value="{=/Strings/STS/L_Copy_Text}" />                     </div>                     {%templateSelect DisableLinkTemplate}                 </div>             </div>',Z='{%version 2.0}             <div class="ms-tableCell ms-manageLink-disable" style="{=ManageLinkStyle}">                 <a id="{=DisableLinkId}" title="{=LinkTitleText}" href="javascript:;" class="ms-heroCommandLink ms-commandLink" onclick="OnDisableLink({=IsEditLink}, this, GetManageLinkParams());return false;">                     {=DisableLinkText}</a>             </div>',T='{%version 2.0}             <label for="{=ManageLinkUrlId}" class="ms-metadata ms-manageLink-tabbed-url-width ms-aclinv-linksSectionDescPadding">{=Description}</label>',V='{%version 2.0}             <div class="ms-tableRow ms-fullWidth">                 <div class="ms-tableCell">                     <a id="js-manageLink-linkTypeDropdown" href="javascript:;" class="ms-manageLink-dropdownLinkContainer ms-core-defaultFont ms-lines ms-fullWidth" onclick="{+onClickSharingLinkMenu}">                         <span id="js-manageLink-linkTypeText" class="ms-manageLink-dropdownText ms-fullWidth" title="{=SharingLinkTypeText}">{=SharingLinkTypeText}</span>                         <img class="ms-manageLink-dropdownArrow" src="{=MenuDropdownArrowImgSrc}" alt="{=/Strings/STS/L_OpenMenu_Text}" />                     </a>                 </div>             </div>',S='{%version 2.0}             <div class="ms-table">                 <div class="ms-tableRow ms-fullWidth">                     <div class="ms-tableCell">                         <div id="js-manageLink-expirationSelector" style="{=SharingLinkExpirationSelectorStyle}">                             <span id="js-manageLink-linkExpirationDate" style="{=SharingLinkExpirationStyle}" class="ms-anonymousLinkExpiration-expirationText">{=SharingLinkExpirationDate}</span>                             <a id="js-manageLink-linkExpirationDropdown" href="javascript:;" class="ms-heroCommandLink ms-commandLink ms-anonymousLinkExpiration-dropdownLinkContainer" onClick="{+onClickExpirationMenu}">                                 <span id="js-manageLink-linkExpirationLabel" class="ms-anonymousLinkExpiration-dropdownText ms-uppercase">{=SharingLinkExpirationLabel}</span>                                 <img class="ms-anonymousLinkExpiration-dropdownArrow" src="{=MenuDropdownArrowImgSrc}" alt="{=/Strings/STS/L_OpenMenu_Text}" />                             </a>                         </div>                     </div>                 </div>                 <div id="js-manageLink-customExpirationDiv" class="ms-tableRow ms-fullWidth" style="display:none">                     <div class="ms-tableCell">                         <div class="ms-anonymousLinkExpiration-expirationText">{=SharingLinkExpirationCustomHtml}</div>                         <a href="javascript:;" id="js-manageLink-expirationSave" class="ms-heroCommandLink ms-commandLink ms-anonymousLinkExpiration-expirationSave" onClick="{+onClickCustomExpirationSave}">{=/Strings/STS/L_SaveButtonCaption}</a>                         <a href="javascript:;" id="js-manageLink-expirationCancel" class="ms-heroCommandLink ms-commandLink ms-anonymousLinkExpiration-expirationSave" onClick="{+onClickCustomExpirationCancel}">{=/Strings/STS/L_CancelButtonCaption}</a>                         <div id="js-manageLink-expirationInputErrorDiv" class="ms-anonymousLinkExpiration-expirationError ms-error ms-fullWidth" style="display:none" role="alert">                             {=/Strings/STS/L_Sharing_ManageLink_LinkExpiration_InvalidValueErrorMessage}                         </div>                     </div>                 </div>             </div>',R='{%version 2.0}             <input type="text" id="js-manageLink-expirationInput" class="ms-manageLink-expirationInput" onmousedown="SelectOnFocus(this, event);" value="{=CurrentExpirationValue}" title="{=/Strings/STS/L_Sharing_ManageLink_LinkExpiration_CustomValueTooltip}"></input>',I="{%version 2.0}",b=new Renderer;b.SetTemplate("main",bb);b.SetTemplate("ManagedLinkRow",Y);b.SetTemplate("SharingLinkSection",U);b.SetTemplate("SharingLinkTypeLabel",W);b.SetTemplate("CreateLink",ab);b.SetTemplate("LinkBox",cb);b.SetTemplate("ErrorMessage",I);b.SetTemplate("LinkTypeSelector",V);b.SetTemplate("LinkTypeDescription",T);b.SetTemplate("LinkLabel",X);b.SetTemplate("LinkExpirationSelector",S);b.SetTemplate("LinkExpirationCustomHTML",R);b.SetTemplate("BlankTemplate",I);b.SetTemplate("DisableLink",Z);SharingLinkExpirationValues[Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_LinkExpiration_Never)]=null;for(var db=24*60,i=[1,30,60],h=0,gb=i.length;h<gb;h++){var eb=String.format(SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_DaysLabelForCallout),Encoding.HtmlEncode(Strings.STS.L_DaysLabelForCalloutIntervals),i[h]),i[h]);SharingLinkExpirationValues[eb]=i[h]*db}SharingLinkExpirationValues[Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_LinkExpiration_Custom)]="Custom";var C=function(b){var d=b.LinkUrl,c=b.IsEditLink,e=typeof sharingInfo=="object"&&typeof sharingInfo.HasEditRole=="boolean"&&typeof sharingInfo.HasViewRole=="boolean"&&(c?sharingInfo.HasEditRole:sharingInfo.HasViewRole);b.LoadingImageSrc="/_layouts/15/images/loadingcirclests16.gif?rev=40";b.DropdownArrowSrc=GetThemedImageUrl("ecbarw.png");b.CopyButtonVisibilityClass="ms-hide";b.AddOrCreateLinkText=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_CreateLink);b.Description=c?Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_EditDesc):Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewOnlyDesc);b.LinkTypeText=c?Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_EditLinkOptionDesc):Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewLinkOptionDesc);b.LinkTypeDescriptionTemplate="LinkTypeDescription";b.LinkLabelTemplate="LinkLabel";b.DisableLinkTemplate="DisableLink";b.CreateLinkProgressText=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ProgressText);b.LinkTypeDescriptionLabel=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_LinkAccess);b.CreateLinkText=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_CreateLink);b.ViewLinkOptionDescription=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewLinkOptionDesc);b.DisableLinkProgressText=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_DisableLinkProgress);b.DisableLinkText=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_Disablelink);if(Boolean(d))b.GuestLinkTemplate="LinkBox";else b.GuestLinkTemplate="CreateLink";if(!a.allowDisableLink)if(!Boolean(d))b.Description=c?Strings.STS.L_Sharing_ManageLink_EditCantView_Message:Strings.STS.L_Sharing_ManageLink_ViewCantView_Message;if(!e){b.GuestLinkTemplate="ErrorMessage";b.Description=c?Strings.STS.L_Sharing_ManageLink_NoEditRole:Strings.STS.L_Sharing_ManageLink_NoViewRole}},u=companySharingLinksFlightOn?"":G?"ms-manageLink-tabbed-qr-url-width":"ms-manageLink-tabbed-url-width",m=G?GenQrImgLink("{0}","vertical-align:middle;"):"",w=!Boolean(a.allowDisableLink)?"display:none":"",K={LinkUrl:a.viewLink,CopyTag:"SharingViewLinkCopied",ManageLinkUrlClass:u,AdditionalHtml:String.format(m,a.viewLink),ManageLinkStyle:w,DisableLinkId:"idDisableReadLnk",AddLinkId:"idReadLnk",LinkTitleText:Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewOnlyDesc),ManageLinkUrlId:"ms-manageLink-url-read",IsEditLink:false,ManageLinkLabelText:Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewOnlyLabel),ManageLinkUrlDivId:"js-manageLinkUrl-View",ManageLinkProgressBarDivId:"js-manageLinkPrgBr-View"};C(K);var J={LinkUrl:a.editLink,CopyTag:"SharingEditLinkCopied",ManageLinkUrlClass:u,AdditionalHtml:String.format(m,a.editLink),ManageLinkStyle:w,DisableLinkId:"idDisableReadWriteLnk",AddLinkId:"idReadWriteLnk",LinkTitleText:Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_EditDesc),ManageLinkUrlId:"ms-manageLink-url-readWrite",IsEditLink:true,ManageLinkLabelText:Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_EditLabel),ManageLinkUrlDivId:"js-manageLinkUrl-Edit",ManageLinkProgressBarDivId:"js-manageLinkPrgBr-Edit"};C(J);var jb=false,O=false,r=false,c="",N="DirectLinkCopied",z=Strings.STS.L_Sharing_ManageLink_DirectLinkLabel,E=0,f=0,s="",t="",y="",L=lb(),D=Boolean(L)?String.format(Strings.STS.L_Sharing_ManageLink_OrganizationTenantAccountRequired,L):Strings.STS.L_Sharing_ManageLink_OrganizationAccountRequired;if(typeof netscape!="undefined")r=typeof netscape.security.PrivilegeManager=="undefined";else if(typeof clipboardData=="undefined")r=true;L_SharingLinkProperties=[];L_SharingLinkProperties[SharingLinkKind.Direct]={SharingLabel:Strings.STS.L_Sharing_ManageLink_DirectLinkLabel,IsEditLink:true,LinkCopyTag:"DirectLinkCopied",Priority:f++,SupportsExpiration:false};L_SharingLinkProperties[SharingLinkKind.OrganizationView]={SharingLabel:String.format(Strings.STS.L_Sharing_ManageLink_DropdownViewOnlyLabel,D),IsEditLink:false,LinkCopyTag:"SharingOrganizationViewLinkCopied",Priority:f++,SupportsExpiration:false};L_SharingLinkProperties[SharingLinkKind.OrganizationEdit]={SharingLabel:String.format(Strings.STS.L_Sharing_ManageLink_DropdownEditLabel,D),IsEditLink:true,LinkCopyTag:"SharingOrganizationEditLinkCopied",Priority:f++,SupportsExpiration:false};L_SharingLinkProperties[SharingLinkKind.AnonymousView]={SharingLabel:String.format(Strings.STS.L_Sharing_ManageLink_DropdownViewOnlyLabel,Strings.STS.L_Sharing_ManageLink_NoSignInRequiredLabel),IsEditLink:false,LinkCopyTag:"SharingAnonymousViewLinkCopied",Priority:f++,SupportsExpiration:true};L_SharingLinkProperties[SharingLinkKind.AnonymousEdit]={SharingLabel:String.format(Strings.STS.L_Sharing_ManageLink_DropdownEditLabel,Strings.STS.L_Sharing_ManageLink_NoSignInRequiredLabel),IsEditLink:true,LinkCopyTag:"SharingAnonymousEditLinkCopied",Priority:f++,SupportsExpiration:true};L_SelectedSharingLinkKind=SharingLinkKind.Direct;if(Boolean(a.sharingLinks)){for(var l=0,ib=a.sharingLinks.length;l<ib;l++){var k=a.sharingLinks[l],g=L_SharingLinkProperties[k.LinkKind];if(Boolean(g)){a.sharingLinks[l].LinkLabel=g.SharingLabel;if(k.IsActive&&!isNaN(g.Priority)&&g.Priority>E){L_SelectedSharingLinkKind=k.LinkKind;E=g.Priority;c=k.Url}}}var e=L_SharingLinkProperties[L_SelectedSharingLinkKind];if(Boolean(e)){z=e.SharingLabel;N=e.LinkCopyTag;O=e.IsEditLink;t=expiryFlightOn&&e.SupportsExpiration?GenerateExpiryTextHTML(c):"";s=Q(L_SelectedSharingLinkKind,c)}}var F=GetExpirationFromLink(c),P=0;if(Boolean(F)){var fb=Math.abs(F.getTime()-+new Date);P=Math.ceil(fb/(1e3*3600*24))}y=String.format(Strings.STS.L_Sharing_ManageLink_LinkExpiration_CustomValueLabel,b.Render("LinkExpirationCustomHTML",{CurrentExpirationValue:P}));var hb={LinksMetadata:!companySharingLinksFlightOn?[K,J]:[],SharingLinksMetadata:{LinkTypeTemplate:Boolean(a.sharingLinks)&&a.sharingLinks.length>1?"LinkTypeSelector":"SharingLinkTypeLabel",SharingLinkTypeText:z,MenuDropdownArrowImgSrc:GetThemedImageUrl("ecbarw.png"),LoadingImageSrc:"/_layouts/15/images/loadingcirclests16.gif?rev=40",ManageLinkUrlId:"js-manageLink-linkBox",CopyTag:N,ManageLinkUrlClass:u,LinkUrl:c,AdditionalHtml:String.format(m,c),CopyButtonVisibilityClass:r?"ms-hide":"",ManageLinkStyle:w,DisableLinkId:"idDisableSharingLnk",DisableLinkTemplate:"DisableLink",DisableLinkText:Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_RemoveLink),IsEditLink:O,SharingLinkExpirationSelectorStyle:expiryFlightOn&&Boolean(s)?"":"display:none",SharingLinkExpirationLabel:s,SharingLinkExpirationDate:t,SharingLinkExpirationStyle:Boolean(t)?"":"display:none",SharingLinkExpirationCustomHtml:y},SharingLinksTemplate:companySharingLinksFlightOn?"SharingLinkSection":"BlankTemplate",DialogContentDivClass:companySharingLinksFlightOn?"ms-manageLink-dialogContent-expanded":""};OnSharingLinksMenuChanged=function(b){if(isNaN(b)||b<0)return;var s=function(c){for(var b=0,d=a.sharingLinks.length;b<d;b++)if(a.sharingLinks[b].LinkKind==SharingLinkKind.Direct||a.sharingLinks[b].LinkKind==c)a.sharingLinks[b].IsActive=true;else if(c==SharingLinkKind.Direct)a.sharingLinks[b].IsActive=false},c=function(b){L_SelectedSharingLinkKind=b;M(a)},g=document.getElementById("js-manageLink-linkTypeDropdown"),m=document.getElementById("js-manageLink-linkBox"),t=document.getElementById("js-manageLink-additionalHtmlDiv"),w=document.getElementById("CopySharingLinkBtn"),u=document.getElementById("idDisableSharingLnk");if(Boolean(m)&&Boolean(g)&&Boolean(a.sharingLinks)&&a.sharingLinks.length>0){var q=x(a.webUrl,a.listId,a.itemId),r=Boolean(a.contextWebUrl)?a.contextWebUrl:a.webUrl;g.focus();if(b==L_SelectedSharingLinkKind)return;var f=L_SelectedSharingLinkKind;c(b);var e=A(a,b);if(Boolean(e)){d(false);B(b,e);return}SP.QoS.WriteUserEngagement("SharingSwitchTo"+v(b)+"LinkType");if(b==SharingLinkKind.OrganizationView||b==SharingLinkKind.OrganizationEdit){var i=function(h,i,g){e=i.CreateOrganizationSharingLink;if(Boolean(e))j(a,b,e);else{p(true,null,a,h,g);c(f)}d(false)},h=function(e,g,b){p(true,null,a,e,b);c(f);d(false)};o(Strings.STS.L_Sharing_ManageLink_CreateLinkProgressText);d(true);CreateOrganizationSharingLink(i,h,r,q,b==SharingLinkKind.OrganizationEdit)}else if(b==SharingLinkKind.AnonymousView||b==SharingLinkKind.AnonymousEdit){var l=function(){c(b);d(false)},k=function(){c(f);d(false)};o(Strings.STS.L_Sharing_ManageLink_CreateLinkProgressText);d(true);n(null,null,b==SharingLinkKind.AnonymousEdit,a,true,null,l,k)}}};b.RegisterHandler("onClickGetLinksDialogClose",function(){HandleOnCloseClick();H(SP.UI.DialogResult.cancel)});b.RegisterHandler("onClickCopySharingLink",function(){var a=document.getElementById("js-manageLink-linkBox");if(Boolean(a)&&Boolean(a.value)){var b=TryCopyStringToClipboard(a.value);if(!b)alert("Failed to copy link URL to clipboard! Please use CTRL+C in the link box instead.");else OnCopyLink("")}});b.RegisterHandler("onSharingLinkDropDownChanged",OnSharingLinksMenuChanged);b.RegisterHandler("onClickSharingLinkMenu",function(g){var d=document.getElementById("js-manageLink-linkTypeDropdown");if(Boolean(d)&&!CSSUtil.HasClass(d,"ms-commandLinkDisabled")){for(var c=CMenu("js-manageLink-sharingLinksMenu"),b=0,f=a.sharingLinks.length;b<f;b++)if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(568)||a.sharingLinks[b].LinkKind!=SharingLinkKind.Direct){var e=Boolean(a.sharingLinks[b].IsActive);CAMOpt(c,e?String.format(Strings.STS.L_Sharing_ManageLink_SharingLinkCreated,a.sharingLinks[b].LinkLabel):a.sharingLinks[b].LinkLabel,"OnSharingLinksMenuChanged("+a.sharingLinks[b].LinkKind+");")}c.setAttribute("largeiconmode","true");c.setAttribute("hideicons","true");MenuHtc_hide();OMenu(c,d,undefined,false)}DOM.CancelEvent(g);return false});b.RegisterHandler("onClickExpirationMenu",function(b){var a=document.getElementById("js-manageLink-linkExpirationDropdown");Boolean(a)&&!CSSUtil.HasClass(a,"ms-commandLinkDisabled")&&OnDropdownClick(b,a)});b.RegisterHandler("onClickCustomExpirationSave",function(d){var g=typeof d.target!="undefined"?d.target:d.srcElement,b=document.getElementById("js-manageLink-expirationInput");if(Boolean(b)&&!CSSUtil.HasClass(g,"ms-commandLinkDisabled")){var f=false,c=parseInt(b.value);if(!isNaN(c)&&String(c)==b.value&&c>=0&&c<=730){f=true;OnCreateLink(a,L_SelectedSharingLinkKind==SharingLinkKind.AnonymousEdit,null,b.value)}var e=document.getElementById("js-manageLink-expirationInputErrorDiv");if(Boolean(e))e.style.display=f?"none":""}});b.RegisterHandler("onClickCustomExpirationCancel",function(a){var c=typeof a.target!="undefined"?a.target:a.srcElement;if(!CSSUtil.HasClass(c,"ms-commandLinkDisabled")){var b=A(GetManageLinkParams(),L_SelectedSharingLinkKind);q(false);B(L_SelectedSharingLinkKind,b)}});return b.Render("main",hb)}DisplayManageLinkDialog=function(a,k,e,g){if(!Boolean(a))return;var b="",h=document.getElementById("GetLinksDialog");if(!Boolean(h)){DisplaySharingDialogCore(a.webUrl,a.listId,a.itemId,1,"0",null,k);return}typeof y=="function"&&y("GetLinksDialog",true);var i=function(i,l,e,h,g,d,k){var c='<div class="ms-metadata ms-manageLink-tabbed-url-width ms-aclinv-linksSectionDescPadding">{0}</div>',f=k?"":"display:none",n=typeof sharingInfo=="object"&&typeof sharingInfo.HasEditRole=="boolean"&&typeof sharingInfo.HasViewRole=="boolean"&&(d?sharingInfo.HasEditRole:sharingInfo.HasViewRole),j=d?"SharingEditLinkCopied":"SharingViewLinkCopied";if(n&&a.allowDisableLink){c=String.format(c,STSHtmlEncode(i));var b=c;if(Boolean(e))b=b+String.format(w,j,e,e,f,h,d);else b=b+String.format(Z,f,g,d);return b}else if(!a.allowDisableLink){if(Boolean(e)){c=String.format(c,STSHtmlEncode(i));b=c;b=b+String.format(w,j,e,e,f,h,d)}else{c=String.format(c,STSHtmlEncode(l));b=c;b=b+String.format(Z,f,g,d)}return b}else{var m=d?Strings.STS.L_Sharing_ManageLink_NoEditRole:Strings.STS.L_Sharing_ManageLink_NoViewRole;return String.format(c,Encoding.HtmlEncode(m))}},j=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(147)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(318);if(j)b=qb(a);else{b=zb;var f=i(Strings.STS.L_Sharing_ManageLink_ViewOnlyDesc,Strings.STS.L_Sharing_ManageLink_ViewCantView_Message,a.viewLink,"idDisableReadLnk","idReadLnk",false,a.allowDisableLink);if(Boolean(f))b+=String.format(cb,Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewOnlyLabel),bb+"View",f,l+"View");f=i(Strings.STS.L_Sharing_ManageLink_EditDesc,Strings.STS.L_Sharing_ManageLink_EditCantView_Message,a.editLink,"idDisableReadWriteLnk","idReadWriteLnk",true,a.allowDisableLink);if(Boolean(f))b+=String.format(cb,Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_EditLabel),bb+"Edit",f,l+"Edit");b+='<div class="ms-core-form-bottomButtonBox">                          <input class="ms-ButtonHeightWidth" type="button" id="CloseBtn" onclick="HandleOnCloseClick();window.frameElement.cancelPopUp();return false;"                              value="'+Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_CloseButton)+'" />                        </div>'}b+="</div>";h.innerHTML=b;if(j&&companySharingLinksFlightOn){DOM.AddEventHandler(h,"onclick",HandleDocumentBodyClick);d(false)}if(typeof e!=="boolean")Accessibility.FocusFirstTabStop(document.getElementById("GetLinksDialogCore"));else if(!e&&!g)document.getElementById("idReadLnk").focus();else if(!e&&g)document.getElementById("idReadWriteLnk").focus();else if(e&&!g)SelectOnFocus(document.getElementById("ms-manageLink-url-read"),null);else e&&g&&SelectOnFocus(document.getElementById("ms-manageLink-url-readWrite"),null);c()};SelectOnFocus=function(a,b){Boolean(a)&&a.select();Boolean(b)&&cancelDefault(b)};DismissTopDlgAndLog=function(a){SP.QoS.WriteUserEngagement("SharingSharedWithTabCloseClicked");DismissTopDlg(a)};DismissTopDlg=function(b){var a=window.top.g_childDialog;if(Boolean(a))if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(103)&&Boolean(a.get_url())){var c=new URI(a.get_url());c.getPath().indexOf("aclinv.aspx")!=-1&&a.close(b)}else a.close(b)};OnCreateLink=function(f,g,h,e){var a=null,c=null,b=null;if(companySharingLinksFlightOn){if(expiryFlightOn&&Boolean(e)){c=function(){d(false);q(false)};b=function(){d(false)};a=pb(e);o(Boolean(a)?Strings.STS.L_Sharing_ManageLink_AddExpirationProgressText:Strings.STS.L_Sharing_ManageLink_RemoveExpirationProgressText)}d(true)}n(h,null,g,f,true,a,c,b)};OnCopyLink=function(a){if(companySharingLinksFlightOn)a="Sharing"+v(L_SelectedSharingLinkKind)+"LinkCopied";SP.QoS.WriteUserEngagement(a)};OnDisableLink=function(b,c,a){var e=null;if(b!=null){var i="js-manageLinkUrl-"+(b?"Edit":"View");e=document.getElementById(i)}if(companySharingLinksFlightOn)SP.QoS.WriteUserEngagement("SharingDisable"+v(L_SelectedSharingLinkKind)+"LinkClick");else if(b)SP.QoS.WriteUserEngagement("SharingDisableEditLinkClick");else SP.QoS.WriteUserEngagement("SharingDisableViewLinkClick");var g=function(){j(a,L_SelectedSharingLinkKind,null);var b=yb(a),c=L_SharingLinkProperties[b];if(b==SharingLinkKind.Uninitialized)b=SharingLinkKind.Direct;L_SelectedSharingLinkKind=b;M(a);d(false)},f=function(c,e,b){d(false);p(false,null,a,c,b)},h=function(i){if(i==SP.UI.DialogResult.OK)if(Boolean(c)&&companySharingLinksFlightOn){if(Boolean(a))if(!isNaN(L_SelectedSharingLinkKind))switch(L_SelectedSharingLinkKind){case SharingLinkKind.OrganizationView:case SharingLinkKind.OrganizationEdit:var j=x(a.webUrl,a.listId,a.itemId),k=Boolean(a.contextWebUrl)?a.contextWebUrl:a.webUrl;o(Strings.STS.L_Sharing_ManageLink_RemoveLinkProgressText);d(true);DestroyOrganizationSharingLink(g,f,k,j,L_SelectedSharingLinkKind==SharingLinkKind.OrganizationEdit);break;case SharingLinkKind.AnonymousView:case SharingLinkKind.AnonymousEdit:o(Strings.STS.L_Sharing_ManageLink_RemoveLinkProgressText);d(true);n(c,e,L_SelectedSharingLinkKind==SharingLinkKind.AnonymousEdit,a,false,null,g,f)}else n(c,e,b,a,false,null,g,f)}else{V(c,e,b);Boolean(a)&&n(c,e,b,a,false,null)}var h;h=document.getElementById("CloseBtn");Boolean(h)&&h.focus()};!CSSUtil.HasClass(c,"ms-commandLinkDisabled")&&ob(h)};OnDropdownClick=function(k,b){for(var e=Object.keys(SharingLinkExpirationValues),f="dropdown-menu",d=CMenu(f),c=0;c<e.length;c++){var i=new RegExp('"',"g"),j='SetExpirationDropdownItem("'+e[c].replace(i,'\\"')+'", "'+b.id+'");';CAMOpt(d,e[c],j)}var a=document.createElement("span");a.id=f;a.style.position="absolute";b.appendChild(a);var h=m$(b).offset().left,g=m$(b).offset().bottom;m$(a).offset({left:h,top:g});d.setAttribute("hideicons","true");MenuHtc_hide();OMenu(d,a,undefined,false);k.stopPropagation();return false};SetExpirationDropdownItem=function(b,a){if(!m$.isElement(a))a=document.getElementById(a);if(Boolean(b))if(b.toUpperCase()=="CUSTOM")q(true);else{OnCreateLink(GetManageLinkParams(),L_SelectedSharingLinkKind==SharingLinkKind.AnonymousEdit,null,b);a.focus()}};GenerateExpiryTextHTML=function(d){var a=GetExpirationFromLink(d);if(!Boolean(a))return"";var b="",c=a==null?Strings.STS.L_Sharing_ManageLink_LinkExpiration_Never:a.toLocaleDateString();b="<div class='ms-anonymousLinkExpiration-expiryDescription'>             <span class='ms-anonymousLinkExpiration-expiryDate ms-soften'>"+Encoding.HtmlEncode(String.format(Strings.STS.L_Sharing_ManageLink_LinkExpiration_DateDescription,c))+"</span>         </div>";return b};GetExpirationFromLink=function(a){if(a!=null&&a.indexOf("expiration=")!=-1){var d=new URI(a),c=d.getQueryParameter("expiration"),b=Date.parse(c.replace(/\+/g," "));if(Boolean(b))return new Date(b)}return null};var Ab=["<div>",STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_ConfirmText),"</div>","<div class='ms-core-form-bottomButtonBox'>","<button id='js-disableLinkBtn' onclick='DismissTopDlg(1)'>",STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_ConfirmButtonOK),"</button>","<button id='js-keepLinkBtn' onclick='DismissTopDlg(0)'>",STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_ConfirmButtonCancel),"</button></div>"];function ob(c){var b=document.createElement("DIV");b.innerHTML=Ab.join("");var d={html:b,title:Strings.STS.L_Sharing_ManageLink_ConfirmTitle,dialogReturnValueCallback:c},e=new SP.UI.ModalDialog.showModalDialog(d),a=document.getElementById("js-keepLinkBtn");if(!Boolean(a)&&Boolean(window.parent))try{a=window.parent.document.getElementById("js-keepLinkBtn")}catch(f){}Boolean(a)&&a.focus()}HandleOnCloseClick=function(){SP.QoS.WriteUserEngagement("SharingGetALinkTabCloseClick")};function v(b){if(isNaN(b)||b<0)return null;var a="";switch(b){case SharingLinkKind.Uninitialized:a="Uninitialized";break;case SharingLinkKind.Direct:a="Direct";break;case SharingLinkKind.OrganizationView:a="OrganizationView";break;case SharingLinkKind.OrganizationEdit:a="OrganizationEdit";break;case SharingLinkKind.AnonymousView:a="AnonymousView";break;case SharingLinkKind.AnonymousEdit:a="AnonymousEdit"}return a}function rb(b,c){var a=document.getElementById(b);if(Boolean(a))a.style.visibility=c?"visible":"hidden"}function V(c,d,a){var b=function(){var b;if(a!=null&&c!=null)b=document.getElementById(l+(a?"Edit":"View"));else b=document.getElementById(l+"All");if(Boolean(b))b.style.visibility="visible"};m(b)}function r(c,e,b){var a;if(b!=null&&c!=null)a=document.getElementById(l+(b?"Edit":"View"));else a=document.getElementById(l+"All");if(Boolean(a))a.style.visibility="hidden"}function p(g,i,h,b,d,e){var f="",a="";if(companySharingLinksFlightOn){var j="SharingCreate"+v(L_SelectedSharingLinkKind)+"LinkServerFailure",k=g?"SharePoint-CreateSharingLink-Error":"SharePoint-DestroySharingLink-Error";a=Boolean(e)?e:typeof b!="undefined"&&b!=null?b.getResponseHeader(k):"";if(!Boolean(a))a=g?Strings.STS.L_Sharing_ManageLink_CreateDefaultError:Strings.STS.L_Sharing_ManageLink_DefaultError;Boolean(d)&&d.UnexpectedFailure(j);SP.DebugLogger.Write(j,SP.DebugLogger.LoggingLevel.Interesting,a);f=g?Strings.STS.L_Sharing_CreateLink_ErrorTitle:Strings.STS.L_Sharing_ManageLink_ErrorTitle}else if(g){a=Boolean(e)?e:typeof b!="undefined"&&b!=null?b.getResponseHeader("SharePoint-CreateSharingLink-Error"):"";if(!Boolean(a))a=Strings.STS.L_Sharing_ManageLink_CreateDefaultError;if(i){d.UnexpectedFailure("SharingCreateEditLinkServerFailure");SP.DebugLogger.Write("SharingCreateEditLinkServerFailure",SP.DebugLogger.LoggingLevel.Interesting,a)}else{d.UnexpectedFailure("SharingCreateViewLinkServerFailure");SP.DebugLogger.Write("SharingCreateViewLinkServerFailure",SP.DebugLogger.LoggingLevel.Interesting,a)}f=Strings.STS.L_Sharing_CreateLink_ErrorTitle}else{a=Boolean(e)?e:typeof b!="undefined"&&b!=null?b.getResponseHeader("SharePoint-DestroySharingLink-Error"):"";if(!Boolean(a)||a=="")a=Strings.STS.L_Sharing_ManageLink_DefaultError;if(i==null){d.UnexpectedFailure("SharingDisableAllLinksServerFailure");SP.DebugLogger.Write("SharingDisableAllLinksServerFailure",SP.DebugLogger.LoggingLevel.Interesting,a)}else if(i){d.UnexpectedFailure("SharingDisableEditLinkServerFailure");SP.DebugLogger.Write("SharingDisableEditLinkServerFailure",SP.DebugLogger.LoggingLevel.Interesting,a)}else{d.UnexpectedFailure("SharingDisableViewLinkServerFailure");SP.DebugLogger.Write("SharingDisableViewLinkServerFailure",SP.DebugLogger.LoggingLevel.Interesting,a)}f=Strings.STS.L_Sharing_ManageLink_ErrorTitle}if(typeof OpenPopUpPageWithTitle=="function"){var c;if(Boolean(h.contextWebUrl)){c=h.contextWebUrl;if(c.substring(c.length-1)!="/")c+="/";c+="_layouts/15/error.aspx?ErrorText="+encodeURIComponent(a)}else c=h.webUrl+"_layouts/15/error.aspx?ErrorText="+encodeURIComponent(a);OpenPopUpPageWithTitle(c,null,null,null,f);if(typeof b!="undefined"&&b!=null)b.onreadystatechange=null}else alert(a)}function n(i,h,b,c,d,s,l,k){var a=[];a.push(c.webUrl);a.push("_layouts/15/aclinv.aspx");a.push("?obj=");a.push("{");a.push(c.listId);a.push("},");a.push(c.itemId);a.push(",DOCUMENT");a.push("&List=");a.push(escapeProperly(c.listId));if(d)a.push("&command=createlink");else a.push("&command=disablelink");a.push("&readwrite=");a.push(String(b));d&&V(i,h,b);var q=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(147)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(318),n=function(f,e,a){p(d,b,c,f,e,a)},o=function(a,c,e){if(d)if(Boolean(a)&&HasValidUrlPrefix(a)&&PageUrlValidation(a)!=""){var f=Encoding.HtmlEncode(a);b?L_AnonymousEditLink=f:L_AnonymousViewLink=f;companySharingLinksFlightOn&&j(GetManageLinkParams(),b?SharingLinkKind.AnonymousEdit:SharingLinkKind.AnonymousView,a);typeof l=="function"&&l(e,c)}else{n(e,c);r(i,h,b,false);typeof k=="function"&&k(e,c)}else{if(b!=null)b?L_AnonymousEditLink="":L_AnonymousViewLink="";else{L_AnonymousEditLink="";L_AnonymousViewLink=""}typeof l=="function"&&l(e,c)}if(typeof window.GetManageLinkParams=="function"){var g=function(){r(i,h,b,true);!companySharingLinksFlightOn&&DisplayManageLinkDialog(window.GetManageLinkParams(),void 0,d,b);if(Boolean(sharingInfo)){if(Boolean(L_AnonymousEditLink)||Boolean(L_AnonymousViewLink))sharingInfo.IsSharedWithGuest=true;else sharingInfo.IsSharedWithGuest=false;z()}};m(g)}},e=null,f=null,g=function(){};if(q){f=function(e,a,c){var b=expiryFlightOn?a.CreateAnonymousLinkWithExpiration:a.CreateAnonymousLink;o(Boolean(a)?Boolean(d)?b:a.DeleteAnonymousLink:null,c,e)};g=function(d,a,c){n(d,c,a);r(i,h,b,false);typeof k=="function"&&k(d,c,a)};e=function(e,f){if(d)CreateAnonymousLink(e,f,Boolean(c.contextWebUrl)?c.contextWebUrl:c.webUrl,a.join(""),b,s);else DestroyAnonymousLink(e,f,Boolean(c.contextWebUrl)?c.contextWebUrl:c.webUrl,a.join(""),b)}}else{f=function(a,d,c){if(a.status!=200){n(a,c);r(i,h,b,false)}else o(a.responseText,c,a)};e=function(b){SendAjaxFormPostWithFormDigest(a.join(""),null,b)}}if(typeof SP!="undefined"&&typeof SP.QoS!="undefined")if(b)if(d)SP.QoS.ExecuteMonitoredAsync("SharingCreateEditLink","SharingCreateEditLinkStart","SharingCreateEditLinkSuccess","SharingCreateEditLinkFailure","SharingCreateEditLinkNoResult",e,f,g);else SP.QoS.ExecuteMonitoredAsync("SharingDisableEditLink","SharingDisableEditLinkStart","SharingDisableEditLinkSuccess","SharingDisableEditLinkFailure","SharingDisableEditLinkNoResult",e,f,g);else if(d)SP.QoS.ExecuteMonitoredAsync("SharingCreateViewLink","SharingCreateViewLinkStart","SharingCreateViewLinkSuccess","SharingCreateViewLinkFailure","SharingCreateViewLinkNoResult",e,f,g);else SP.QoS.ExecuteMonitoredAsync("SharingDisableViewLink","SharingDisableViewLinkStart","SharingDisableViewLinkSuccess","SharingDisableViewLinkFailure","SharingDisableViewLinkNoResult",e,f,g);else e(f,g)}function R(e,a){var k=Encoding.HtmlEncode(a?Strings.STS.L_Share_FolderLockdownMode_SiteAdminMessage:Strings.STS.L_Share_FolderLockdownMode_NonAdminMessage),h=Encoding.HtmlEncode(a?Strings.STS.L_Share_LockdownMode_ManageFeaturesButtonText:Strings.STS.L_Share_LockdownMode_ShareSiteButtonText),f=Encoding.HtmlEncode(a?Strings.STS.L_Share_LockdownMode_ShareSiteButtonText:Strings.STS.L_CloseButtonCaption),c=document.createElement("div");c.id="Share_LockdownNotificationDlg";var g=function(){NavigateParentOrSelfCore(GetLayoutsPageUrl(e,"ManageFeatures.aspx","?Scope=Site"),true);return false},d=function(){window.parent.setTimeout('DisplaySharingDialog("'+e+'");',0);DismissTopDlg(0);return false},i=function(){DismissTopDlg(0);return false},l={lockdownMessage:k,lockdownActionButtonCaption:h,lockdownAlternateActionButtonCaption:f},j="{%version 2.0}                        <div class='ms-core-form-section'>{=lockdownMessage}</div>                        <div class='ms-core-form-section'>                            <div class='ms-core-form-bottomButtonBox'>                                <input type='button' id='Share_LockdownActionBtn' onclick='{+lockdownActionButton_click}' value='{=lockdownActionButtonCaption}' class='ms-button-emphasize'></input>                                <input type='button' id='Share_LockdownAlternateActionBtn' onclick='{+lockdownAlternateActionButton_click}' value='{=lockdownAlternateActionButtonCaption}'></input>                            </div>                        </div>",b=new Renderer;b.SetTemplate("main",j);b.RegisterHandler("lockdownActionButton_click",a?g:d);b.RegisterHandler("lockdownAlternateActionButton_click",a?d:i);c.innerHTML=b.Render("main",l);return c}function K(a,e,b){if(Boolean(a)){var d=R(e,b);a.appendChild(d);c()}}RenderLockdownModeDialog=function(b,a){EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){var c=R(b,a),d={html:c,title:Strings.STS.L_Share_LockdownMode_DialogTitle,autoSize:true},e=new SP.UI.ModalDialog.showModalDialog(d)})};RenderLockdownModeInContainer=function(b,c,a){K(document.getElementById(b),c,a)};function H(b){if(window.frameElement!=null&&typeof window.frameElement.commitPopup==="function")window.frameElement.commitPopup();else{var a=window.top.g_childDialog;Boolean(a)&&a.close(b)}}function c(){if(window.frameElement!=null&&typeof window.frameElement.autoSize==="function")window.frameElement.autoSize();else{var a=window.top.g_childDialog;Boolean(a)&&a.autoSize()}}function m(a){if(window.frameElement!=null&&typeof window.frameElement.autoSizeSuppressScrollbar=="function")window.frameElement.autoSizeSuppressScrollbar(a);else{a();c()}}function xb(c){var a=document.getElementById("divMoreOptions").style.display!=="none";!a&&SP.QoS.WriteUserEngagement("SharingInviteShowOptionsClicked");a=Boolean(c)||!a;m(wb(a));var b=document.getElementById("Share_ShowHideMoreOptions");Boolean(b)&&setInnerText(b,Encoding.HtmlEncode(a?Strings.STS.L_Share_HideOptions:Strings.STS.L_Share_ShowOptions))}function wb(a){return function(){var b=document.getElementById("divMoreOptions");Db(b,a);a&&Accessibility.FocusFirstTabStop(b)}}function Db(a,b){if(a!=null)a.style.display=b?"":"none"}function Bb(a){return a!=null&&a.value!=null&&a.value.toLowerCase().startsWith("group:")}var g=[],t=false,s="",D="",f=[],O=[],F=[],T=[];function nb(){if(t)return Strings.STS.L_Share_PageWelcomeMessageNoDetails;else if(Boolean(s))return String.format(Strings.STS.L_Share_PageWelcomeMessageFormat_AddToGroupMode,s);else{var a=document.getElementById("DdlGroup");if(a!=null&&a.length>0){var g=Bb(a);if(Boolean(sharingInfoRefactorFeature)){var c="";if(a.selectedIndex!=-1&&Boolean(f[a.selectedIndex]))c=f[a.selectedIndex].PermissionDescription;return String.format(Strings.STS.L_Share_PageWelcomeMessage,c)}else if(g){var h=F[a.selectedIndex],d=O[a.selectedIndex];return String.format(Strings.STS.L_Share_PageWelcomeMessage,d)}else{var e=T[a.selectedIndex-F.length];return String.format(Strings.STS.L_Share_PageWelcomeMessage,e)}}else{var b=document.getElementById("DdlSimplifiedRoles");if(b!=null&&b.length>0)return Strings.STS.L_Share_PageWelcomeMessageNoDetails}}return null}function kb(){var a=document.getElementById("Label_Aclinv_PageWelcomeDescription");if(a!=null){if(!t&&!Boolean(s)&&Boolean(D))a.innerHTML=String.format(Strings.STS.L_Share_PageWelcomeDescription_WithInheritance,D);else CSSUtil.AddClass(a,"ms-hide");c()}}function W(){var c=document.getElementById("chkSendEmailv15"),d=Boolean(c)&&c.checked,b=document.getElementById("divEmailBody");b!=null&&SetChildControlsDisabledStatus(b,!d);var a=document.getElementById("chkRequireSignIn");if(a!=null)a.checked=true}var S=false,L=false,N=false,a=null;function C(b){var a=null;if(SPClientPeoplePicker!=null&&SPClientPeoplePicker.SPClientPeoplePickerDict!=null)if(b!=null)a=SPClientPeoplePicker.SPClientPeoplePickerDict[b];else for(var c in SPClientPeoplePicker.SPClientPeoplePickerDict){a=SPClientPeoplePicker.SPClientPeoplePickerDict[c];if(a!=null)break}return a}function gb(l,b){if(a==null)a=C(l);if(a!=null){var e=document.getElementById("chkSendEmailv15");if(e!=null)if(a.HasResolvedUnverifiedEmail()){e.checked=true;e.disabled=true}else e.disabled=false;var h="peoplePicker_ValidateNoPermissionToInviteGroups",f=document.getElementById(h);if(Boolean(t)&&Boolean(f)&&Boolean(b)&&b.length>0){CSSUtil.AddClass(f,"ms-hide");g[h]=false;for(var d=0,m=b.length;d<m;d++)if(Boolean(b[d].IsResolved)){var i=b[d].EntityData.PrincipalType;if(!Boolean(i))i=b[d].EntityType;if("SharePointGroup"==i){g[h]=true;CSSUtil.RemoveClass(f,"ms-hide");break}}}var j=false;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(305)){var k=document.getElementById("aclinv_SharingTips");j=RenderDLPLite(k,b,c)}if(S&&a.HasResolvedUnverifiedEmail()&&!j)if(N&&!L)alert(Strings.STS.L_Sharing_External_Sharing_Warning);else{a.ShowErrorMessage(Strings.STS.L_Sharing_External_Sharing_Warning);L=true}}c()}function hb(){c()}var sb="{%version 2.0}        <div id='pageStatusBar'></div>        <div class='ms-core-form ms-aclinv-dialog'                 id='mainAclinv'>            <div class='ms-core-form-section'                     id='divSharingInformation'>            </div>            <div id='sharingDialogMainContentRegion'>                <table id='tabbedControl' role='presentation'                         class='ms-aclinv-tabbedControl'>                    <tr class='ms-aclinv-tabbedCtrl-td'>                        <td id='tabsTD'                            class='ms-aclinv-tabborder ms-aclinv-tabbedControl-tabs'>                            <div class='noindex ms-core-listMenu-verticalBox'>                                <ul class='ms-noList ms-core-listMenu-root'>                                    <li id='lnkShrItem'                                         class='static'>                                        <a id='lnkShrDlg'                                            aria-selected='true'                                            class='ms-aclinv-tabbedControl-tabLinks static menu-item ms-core-listMenu-item ms-displayInline ms-navedit-linkNode selected ms-core-listMenu-selected'                                            href='javascript:;'                                            onclick='{+onClickInviteTab}'>                                            {=/Strings/STS/L_SharedWithDialogInvitePeople}                                        </a>                                    </li>                                    <li id='lnkGetLnkItem'                                         class='static'>                                        <a id='lnkGetLnkDlg'                                            class='ms-aclinv-tabbedControl-tabLinks static menu-item ms-core-listMenu-item ms-displayInline ms-navedit-linkNode'                                            href='javascript:;'                                            onclick='{+onClickGetLinksTab}'>                                            {=/Strings/STS/L_Share_GetLinks}                                        </a>                                    </li>                                    <li id='lnkSharedWithDlgItem'                                         class='static'>                                        <a id='lnkSharedWithDlg'                                            class='ms-aclinv-tabbedControl-tabLinks static menu-item ms-core-listMenu-item ms-displayInline ms-navedit-linkNode'                                            href='javascript:;'                                            onclick='{+onClickSharedWithTab}'>                                            {=/Strings/STS/L_Share_SharedWith}                                        </a>                                    </li>                                </ul>                            </div>                        </td>                        <td class='ms-aclinv-tabbedControl-centralPadding' id='tabCenter'></td>                        <td class='ms-aclinv-tabbedControl-tabPanel'>                            <div>                                <div id='SharingDialogCore'>                                    <div id='sharingDlgDiv'>                                        <div class='ms-core-form-section'>                                            <div class='ms-core-form-subsection'                                                     id='WelcomeAreaFormSection'>                                                <span id='divWelcomeMessage'                                                     class='ms-h3 ms-soften ms-core-form-line'>                                                    <span id='Label_Aclinv_PageWelcomeMessage'></span>                                                </span>                                                <div id='divWelcomeDescription'                                                         class='ms-core-form-line'>                                                    <span id='Label_Aclinv_PageWelcomeDescription'></span>                                                </div>                                            </div>                                            <div class='ms-core-form-subsection'>                                                <div class='ms-table ms-fullWidth'>                                                    <div class='ms-tableRow'>                                                        <div class='ms-tableCell ms-fullWidth ms-aclinv-people-picker'>                                                            <div id='peoplePicker'></div>                                                            <div id='aclinv_SharingTips'></div>                                                        </div>                                                        <div id='PanelSimplifiedRoleSelector'                                                                 class='ms-tableCell ms-verticalAlignTop ms-aclinv-simplified-roles-container ms-hide'>                                                            <select id='DdlSimplifiedRoles' title='{=/Strings/STS/L_ChoosePermissionLevelAltText}'                                                                     class='ms-aclinv-simplified-roles ms-floatRight'></select>                                                        </div>                                                    </div>                                                </div>                                                <span id='peoplePicker_ValidateNoPermissionToInviteGroups'                                                      class='ms-error ms-hide' role='alert'>{=/Strings/STS/L_Share_NoPermissionToInviteGroups}</span>                                            </div>                                            <div class='ms-core-form-subsection'>                                                <div class='ms-core-form-line'                                                        id='divEmailBody'>                                                    <textarea title='{=/Strings/STS/L_Share_EmailBody_Title}'                                                                 class='ms-fullWidth ms-aclinv-message-input'                                                                 id='TxtEmailBody'                                                                 rows='6'                                                                 cols='40'                                                                 placeholder='{=/Strings/STS/L_EmailBody_HelperText}'                                                                alwaysenablesilent='true' ></textarea>                                                </div>                                                <div class='ms-core-form-line'>                                                    <div id='divRequireSignIn' class='ms-hide'>                                                        <span class='ms-aclinv-checkbox'>                                                            <input id='chkRequireSignIn'                                                                     type='checkbox'>                                                            <label for='chkRequireSignIn'>                                                                <span title='{=/Strings/STS/L_Share_RequireSignIn_TooltipDescription}'                                                                        class='ms-tooltip'>{=/Strings/STS/L_Share_RequireSignIn_Checkbox}</span>                                                            </label>                                                        </span>                                                    </div>                                                </div>                                            </div>                                        </div>                                        <div id='divPropagateAcl' class='ms-hide ms-core-form-section'>                                            <input id='chkAclPropagation'                                                    type='checkbox'                                                   id='chkAclPropagation'                                                   class = 'ms-aclinv-checkbox'>                                            <label for='chkAclPropagation'>                                                <span>{=/Strings/STS/L_Share_PropagateAcl}</span>                                            </label>                                        </div>                                        <div class='ms-core-form-section ms-aclinv-show-hide-options'>                                            <div id='PanelShowHideMoreOptions'>                                                <a href='javascript:;'                                                     id='Share_ShowHideMoreOptions'                                                    class='ms-commandLink'                                                    onclick='{+onClickShowMoreOptions}'>{=/Strings/STS/L_Share_ShowOptions}</a>                                            </div>                                        </div>                                        <div class='ms-core-form-section'>                                            <div id='divMoreOptions' style='display:none'>                                                <div class='ms-core-form-subsection ms-aclinv-checkbox ms-hide'                                                        id='divSendEmailv15'>                                                    <span class=''>                                                        <input id='chkSendEmailv15'                                                                type='checkbox'                                                                checked='checked'                                                                onclick='{+onClickChkSendEmail}' />                                                        <label for='chkSendEmailv15'>                                                            <span>{=/Strings/STS/L_SendEmailCheckboxv15}</span>                                                        </label>                                                    </span>                                                    <br />                                                </div>                                                <div id='divGivePermissions' class='ms-core-form-subsection'>                                                    <div id='headingGivePermissions' class='ms-h3 ms-soften ms-core-form-line'>{=headingGivePermissionsText}</div>                                                    <div class='ms-core-form-line'>                                                        <select id='DdlGroup'                                                                class='ms-fullWidth'                                                                onchange='{+onGroupDropDownChanged}' ></select>                                                        <br />                                                        <span id='CusValGroup'                                                                class='ms-error ms-hide'                                                                role='alert'>{=/Strings/STS/L_Share_CannotEditMembership}</span>                                                        <div id='PanelPictureLibraryNote'                                                                class='ms-hide'>                                                            <br /><br />                                                            <span class='ms-alerttext'>{=/Strings/STS/L_Share_PicLibNoteLabel}</span>                                                            {=/Strings/STS/L_Share_PicLibNote}                                                        </div>                                                    </div>                                                </div>                                            </div>                                        </div>                                        <div class='ms-core-form-section ms-core-form-bottomButtonBox'>                                            <img id='ms-share-prgBar'                                                    alt='{=/Strings/STS/L_Share_LoadingAltText}'                                                    class='ms-hide'                                                    src='{=loadingCirlceImage}'                                                    onclick='this.style.display=\"none\";' />                                            <input id='btnShare'                                                    class='ms-button-emphasize ms-aclinv-share-button'                                                    onclick='{+onClickBtnShare}'                                                    type='button'                                                    value='{=/Strings/STS/L_Share_SubmitButton_Text}'                                                    accesskey='{=/Strings/STS/L_Share_SubmitButton_AccessKey}' />                                            <input class='ms-ButtonHeightWidth ms-aclinv-cancel-button'                                                    type='button'                                                    id='BtnCancel'                                                    onclick='{+onClickBtnCancel}'                                                    value='{=/Strings/STS/L_CancelButtonCaption}'                                                    accesskey='{=/Strings/STS/L_SelectForeColorKey_TEXT}' />                                        </div>                                    </div>                                </div>                                <div id='GetLinksDialogCore'>                                    <div id='GetLinksDialog'                                         class='ms-hide' ></div>                                </div>                                <div id='SharedWithDlgCore'>                                    <div id='SharedWithDlg'                                         class='ms-hide' ></div>                                </div>                            </div>                        </td>                    </tr>                </table>            </div>        </div>",Hb;DisplayClientSharingDialog=function(l,d,i,c,h,j,b,g){if(!Boolean(d))return false;if(Boolean(a))a=null;var k=0,e=function(e,a){fb(a,d,i,c,j,b)},f=function(a,c){GetSharingSettings(a,c,typeof b!="undefined"&&Boolean(b)?b:l,d,k,g)};if(Boolean(h))EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showWaitScreenWithNoClose",function(){var a=function(){DismissTopDlg(0)};SP.UI.ModalDialog.showWaitScreenWithNoClose(SP.Res.genericLoading,null,null,null);f(function(c,b){a();e(c,b)},function(d,b){a();typeof c=="function"&&c(SharingDialogReturnCode.Error,"Sharing context retrieval failed: "+b)})});else f(e,c);return true};function fb(b,cb,r,n,m,k){for(var p=typeof r==="undefined"||r==null,e=b.SharePointSettings,Q=e.RequiredScriptFileLinks.results,d=0,l=Q.length;d<l;d++){var bb=new URI(Q[d]),Z=bb.getPath(),u=Z.substring(Z.lastIndexOf("/")+1),eb=u.indexOf(".debug.js");if(eb>0)u=u.substr(0,eb)+".js";RegisterSod(u,bb.getString())}var i=b.ObjectSharingInformation,G=i.CanBeShared,fb=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(194),x=!i.CanManagePermissions&&!b.AccessRequestMode&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(454);if(!G&&fb&&(!Boolean(m)||m==SharingTabToShow.SharingDialog)){if(p)RenderLockdownModeDialog(b.WebUrl,b.IsUserSiteAdmin);else K(r,b.WebUrl,b.IsUserSiteAdmin);return}var db=b.ListId,Y=b.ItemName,M=b.SupportsAclPropagation,jb=b.PermissionsOnlyMode,P=b.CanCurrentUserRetrieveReadonlyLink,A=P,U=e.SharedWithEnabled,X=e.TxtEmailSubjectText,q=e.PickerProperties,R="MoreOptions";L_CanManageLink=b.CanCurrentUserManageReadWriteLink||b.CanCurrentUserManageOrganizationReadWriteLink;L_WebUrl=b.WebUrl;L_ContextWebUrl=k;L_ListID=db=="00000000-0000-0000-0000-000000000000"?null:db;L_ItemID=b.ItemId;L_ItemName=Y;L_ItemUrl=b.ItemUrl;L_UserDispUrl=e.UserDisplayUrl;S=b.ShowExternalSharingWarning;if(companySharingLinksFlightOn&&Boolean(i)&&Boolean(i.SharingLinks)){L_SharingLinks=i.SharingLinks.results;if(Boolean(L_ItemID)&&Boolean(L_SharingLinks)){L_SharingLinks=m$.filter(L_SharingLinks,function(a){return!L_CanManageLink&&(!Boolean(a.Url)||!a.IsActive)?false:!(a.LinkKind==SharingLinkKind.AnonymousView&&!b.CanCurrentUserRetrieveReadonlyLink)&&!(a.LinkKind==SharingLinkKind.AnonymousEdit&&!b.CanCurrentUserRetrieveReadWriteLink)});if(L_SharingLinks.length>0)A=true}}else L_SharingLinks=null;if(P&&Boolean(i)&&i.IsSharedWithGuest){L_AnonymousViewLink=i.AnonymousViewLink;L_AnonymousEditLink=i.AnonymousEditLink}else{L_AnonymousViewLink=null;L_AnonymousEditLink=null}sharingInfo={};sharingInfo.HasEditRole=b.HasEditRole;sharingInfo.HasViewRole=b.HasReadRole;I(i);var B=true,v=3;if(!A)v--;if(!U)v--;if(!G)v--;B=v>=2;t=b.AccessRequestMode;s=e.AddToGroupModeName;D=b.InheritingWebLink;if(Boolean(sharingInfoRefactorFeature))f=b.SharingPermissions.results;else{O=e.GroupRoleDefinitionNamesLines.results;T=e.RoleDefinitionNameLines.results;F=e.GroupNameLines.results}var lb=function(){if(a==null)a=C(null);var m=function(){if(a==null)a=C(null);if(a!=null){a.Validate();c();if(!Boolean(a.HasInputError)&&!Boolean(a.HasServerError)){g.peoplePickerError=false;return true}}g.peoplePickerError=true;return false},j=0;if(m()){var q=a.GetCurrentEditorValue();if(q!=null&&q!=""){a.CloseAutoFill();a.AddUnresolvedUserFromEditor(false);g.peoplePickerError=true;a.ResolveAllUsers(function(){m()&&f()})}j=a.TotalUserCount}var d=document.getElementById("DdlSimplifiedRoles");if(d==null||d.length==0)d=document.getElementById("DdlGroup");var e="CusValGroup",i=document.getElementById(e),o="group:";if(!Boolean(g[e])&&Boolean(i)&&Boolean(d)&&Boolean(d.value)&&d.value.indexOf(o)==0){var u=d.value.substring(o.length),l=parseInt(u);if(!isNaN(l)&&l>0){var t="_api/"+(Boolean(k)?"SP.RemoteWeb(@url)/GetGroupById(@groupId)":"web/SiteGroups/GetByID(@groupId)")+"/CanCurrentUserEditMembership?@groupId="+String(l)+(Boolean(k)?"&@url='"+b.WebUrl+"'":""),s=function(b,a){if(!Boolean(a.CanCurrentUserEditMembership)){CSSUtil.RemoveClass(i,"ms-hide");g[e]=true;c()}else{CSSUtil.AddClass(i,"ms-hide");g[e]=false;c();f()}},r=function(){f()};g[e]=true;h(s,r,Boolean(k)?k:b.WebUrl,t,null)}}var f=function(){for(var v in g)if(Boolean(g[v]))return;N=true;var l=document.getElementById("btnShare");if(Boolean(l))l.disabled=true;var h=document.getElementById("ms-share-prgBar");Boolean(h)&&CSSUtil.RemoveClass(h,"ms-hide");var f=document.getElementById("chkSendEmailv15"),e=document.getElementById("chkRequireSignIn"),i=document.getElementById("TxtEmailBody"),s=document.getElementById("chkAclPropagation"),m=false;if(e!=null)m=e.checked;var u=false;if(f!=null)u=f.checked;var c="";if(d!=null){var r=d.value;switch(r){case"role:1073741827":c="Contribute";break;case"role:1073741826":c="View";break;case"role:1073741829":c="Full Control";break;case"role:1073741828":c="Design";break;case"role:1073741830":c="Edit";break;default:c=r}}var t=b.ListId=="00000000-0000-0000-0000-000000000000"&&!Boolean(b.ItemId)&&Boolean(b.SharePointSettings.PanelSimplifiedRoleSelectorVisible);if(t)SP.QoS.WriteUserEngagement("SharingDialogShareButtonClickedOnSiteSharing",{RequireSignIn:e,SendEmail:f,Users:j,Type:c});else SP.QoS.WriteUserEngagement("SharingDialogShareButtonClicked",{RequireSignIn:e,SendEmail:f,Users:j,Type:c});var q=function(f,a){if(Boolean(a)){var d=[],c=[],b=0;if(Boolean(a.UsersAddedToGroup)&&Boolean(a.UsersAddedToGroup.results)){c=a.UsersAddedToGroup.results;for(b=0;b<c.length;b++)d.push(c[b].DisplayName)}if(Boolean(a.UniquelyPermissionedUsers)&&Boolean(a.UniquelyPermissionedUsers.results)){c=a.UniquelyPermissionedUsers.results;for(b=0;b<c.length;b++)d.push(c[b].DisplayName)}var e=Boolean(a.InvitedUsers)&&d.length==0;EnsureScriptFunc("core.js","addSharingNotification",function(){addSharingNotification(a.Name,a.IconUrl,d,a.StatusCode==1,!m,e,false)})}typeof n=="function"&&n(SharingDialogReturnCode.Success);p&&H(SP.UI.DialogResult.OK)},o=function(b,a){if(Boolean(l))l.disabled=false;Boolean(h)&&CSSUtil.AddClass(h,"ms-hide");typeof n=="function"&&n(SharingDialogReturnCode.Error,"Sharing failed: "+a)};if(x)ForwardObjectLink(q,o,Boolean(k)?k:b.WebUrl,cb,a!=null?a.GetControlValueAsText():null,X,i!=null?i.value:null);else ShareObject(q,o,Boolean(k)?k:b.WebUrl,cb,a!=null?a.GetControlValueAsText():null,d!=null?d.value:null,0,s!=null&&s.checked,f!=null&&f.checked,e!=null&&!e.checked,X,i!=null?i.value:null)};f()},j=new Renderer;j.SetTemplate("main",sb);j.RegisterHandler("onClickInviteTab",function(){SP.QoS.WriteUserEngagement("SharingInviteTabClicked");y("sharingDlgDiv",true);return false});j.RegisterHandler("onClickGetLinksTab",function(){SP.QoS.WriteUserEngagement("SharingDialogGetALinkTabClicked");ab();return false});j.RegisterHandler("onClickSharedWithTab",function(){SP.QoS.WriteUserEngagement("SharingDialogSharedWithTabClicked");E();return false});j.RegisterHandler("onClickShowMoreOptions",function(){xb(false)});j.RegisterHandler("onClickChkSendEmail",W);j.RegisterHandler("onGroupDropDownChanged",L);j.RegisterHandler("onClickBtnShare",lb);j.RegisterHandler("onClickBtnCancel",function(){SP.QoS.WriteUserEngagement("SharingInviteTabCloseClicked");p&&H(SP.UI.DialogResult.cancel);typeof n=="function"&&n(SharingDialogReturnCode.Cancel)});var mb={loadingCirlceImage:"/_layouts/15/images/loadingcirclests16.gif?rev=40",headingGivePermissionsText:jb?Strings.STS.L_Share_Step2Title1v15_PermissionsOnlyMode:Strings.STS.L_Share_Step2Title1v15},V=p?document.createElement("div"):r;V.innerHTML=j.Render("main",mb);var J=function(){registerCssLink(e.SharingCssLink);var I=q.PrincipalSource,g={};g.Required=true;g.AllowMultipleValues=true;g.VisibleSuggestions=n?5:2;g.Rows=3;g.Width="100%";g.SetFocus=true;g.PrincipalAccountType=q.PrincipalAccountType;g.AllowEmailAddresses=q.AllowEmailAddresses;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(334))g.AllowOnlyEmailAddresses=q.AllowOnlyEmailAddresses;g.SearchPrincipalSource=I;g.ResolvePrincipalSource=I;g.OnUserResolvedClientScript=gb;g.OnControlValidateClientScript=hb;EnsureScriptFunc("clientforms.js","SPClientPeoplePicker_InitStandaloneControlWrapper",function(){EnsureScript("clientpeoplepicker.js",typeof SPClientPeoplePicker,function(){SPClientPeoplePicker.InitializeStandalonePeoplePicker("peoplePicker",null,g);c()})});var a,t=document.getElementById("PanelSimplifiedRoleSelector");if(Boolean(t)&&e.PanelSimplifiedRoleSelectorVisible){var k=document.getElementById("DdlSimplifiedRoles");if(Boolean(k)&&!x){for(var J=b.SimplifiedRoles.results,D=e.SelectedGroup,h=0,cb=J.length;h<cb;h++){var j=J[h],X;if(Boolean(sharingInfoRefactorFeature)){if(Boolean(f[h])&&Boolean(f[h].PermissionDescription)&&j.Value==f[h].PermissionId)X=f[h].PermissionDescription;o(k,j.Key,j.Value,X);if(Boolean(D)&&j.Value==D)k.selectedIndex=k.length-1}else{a=document.createElement("option");a.innerText=j.Key;a.text=j.Key;a.value=j.Value;a.title=e.GroupNameLines.results[h];k.appendChild(a)}}k.length>0&&CSSUtil.RemoveClass(t,"ms-hide")}}var n=b.CanSendEmail,i=document.getElementById("DdlGroup"),S=document.getElementById("TxtEmailBody");S!=null&&n&&ElementCreator("textarea",S);var P=document.getElementById("divEmailBody");P!=null&&!n&&CSSUtil.AddClass(P,"ms-hide");if(M){var H=document.getElementById("divPropagateAcl");H!=null&&CSSUtil.RemoveClass(H,"ms-hide");var y=document.getElementById("chkAclPropagation");if(y!=null)y.checked=true}var Q=document.getElementById("divSendEmailv15");Q!=null&&n&&CSSUtil.RemoveClass(Q,"ms-hide");var F=document.getElementById("divRequireSignIn");Boolean(F)&&b.CanSendLink&&CSSUtil.RemoveClass(F,"ms-hide");var v=document.getElementById("divGivePermissions");if(Boolean(v))if(e.PanelGivePermissionsVisible){if(Boolean(i))if(Boolean(sharingInfoRefactorFeature))if(Boolean(simpleSiteSharingFeature))ib();else w();else{var N=e.SelectedGroup,Y=b.GroupsList.results;for(d=0,l=Y.length;d<l;d++){var p=Y[d];a=document.createElement("option");a.innerText=p.Key;a.text=p.Key;a.value=p.Value;i.appendChild(a);if(Boolean(N)&&p.Value==N)i.selectedIndex=i.length-1}var bb=b.Roles.results;for(d=0,l=bb.length;d<l;d++){var s=bb[d];a=document.createElement("option");a.innerText=s.Key;a.text=s.Key;a.value=s.Value;i.appendChild(a)}}}else CSSUtil.AddClass(v,"ms-hide");var r=document.getElementById("PanelShowHideMoreOptions");r!=null&&!n&&(i==null||i.length==0)&&CSSUtil.AddClass(r,"ms-hide");x&&CSSUtil.AddClass(r,"ms-hide");var u=document.getElementById("PanelPictureLibraryNote");Boolean(u)&&b.IsPictureLibrary&&CSSUtil.RemoveClass(u,"ms-hide");if(B){var C=document.getElementById("divWelcomeMessage");Boolean(C)&&CSSUtil.AddClass(C,"ms-hide")}else{var Z=document.getElementById("tabsTD");Boolean(Z)&&CSSUtil.AddClass(Z,"ms-hide");var V=document.getElementById("tabCenter");Boolean(V)&&CSSUtil.AddClass(V,"ms-hide")}if(e.IsMobileView){var K=document.getElementById("mainAclinv");Boolean(K)&&CSSUtil.AddClass(K,"ms-aclinv-mobile")}z();kb();W();L();if(!G){var T=document.getElementById("lnkShrItem");Boolean(T)&&CSSUtil.AddClass(T,"ms-hide")}if(!A){var R=document.getElementById("lnkGetLnkItem");Boolean(R)&&CSSUtil.AddClass(R,"ms-hide")}else Boolean(m)&&m==SharingTabToShow.GetLinks&&ab();if(!U){var O=document.getElementById("lnkSharedWithDlgItem");Boolean(O)&&CSSUtil.AddClass(O,"ms-hide")}else Boolean(m)&&m==SharingTabToShow.SharedWith&&E();c()};function o(d,c,e,b){if(!Boolean(d))return;var a=document.createElement("option");a.innerText=STSHtmlEncode(c);a.text=c;a.value=e;if(Boolean(b))a.title=b;d.appendChild(a)}function ib(){var a=document.getElementById("DdlGroup");if(!Boolean(a)||!Boolean(sharingInfoRefactorFeature)||!Boolean(simpleSiteSharingFeature))return;var c=e.SelectedGroup;for(d=0;d<f.length;d++){var b=f[d];if(b.IsDefaultPermission){var g=Boolean(f[d].PermissionDescription)?f[d].PermissionDescription:"";o(a,b.PermissionName,b.PermissionId,g);if(Boolean(c)&&b.PermissionId==c)a.selectedIndex=a.length-1}}if(a.length>0)o(a,Strings.STS.L_SiteSharePerm_ShowMore,R);else w()}function w(){var a=document.getElementById("DdlGroup");if(!Boolean(a)||!Boolean(sharingInfoRefactorFeature))return;var c=e.SelectedGroup,h;a.length=0;for(d=0,l=f.length;d<l;d++){var b=f[d],g="";if(Boolean(b)&&Boolean(b.IsDefaultPermission))g=b.PermissionDescription;o(a,b.PermissionName,b.PermissionId,g);if(Boolean(c)&&b.PermissionId==c)a.selectedIndex=a.length-1}a.length==0&&o(a,Strings.STS.L_LookupFieldNoneOption,"")}function L(){var a=document.getElementById("DdlGroup");if(Boolean(sharingInfoRefactorFeature)&&Boolean(simpleSiteSharingFeature)&&Boolean(a)&&a.selectedIndex!=-1&&a.options[a.selectedIndex].value==R){w();SP.QoS.WriteUserEngagement("SimpleSiteSharing_AdvancedPermission_ShowMoreOptionsClicked")}var d=document.getElementById("Label_Aclinv_PageWelcomeMessage");if(Boolean(d))d.innerHTML=nb();var e="CusValGroup",b=document.getElementById("CusValGroup");if(Boolean(b)){CSSUtil.AddClass(b,"ms-hide");g[e]=false}c()}var ob=null;if(p)EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){var a=B?595:450,b={html:V,title:String.format(M?Strings.STS.L_Share_PageTitleFormat_withAclPropagation:Strings.STS.L_Share_PageTitleFormat,Y),allowMaximize:false,includeScrollBarPadding:false,autoSizeStartWidth:a};ob=SP.UI.ModalDialog.showModalDialog(b);J()});else J()}function e(b){var c=b;if(Boolean(b)){var a=document.createElement("A");a.style.display="none";a.href=b;document.body.appendChild(a);c=a.href}return c}function Cb(){var a=document.getElementById("BtnCancel");Boolean(a)&&a.focus()}function y(d,e){var a=[];a.sharingDlgDiv="lnkShrDlg";a.GetLinksDialog="lnkGetLnkDlg";a.SharedWithDlg="lnkSharedWithDlg";var b=function(){for(var h in a){var b=document.getElementById(h);if(Boolean(b)){AddCssClassToElement(b,"ms-hide");b.style.opacity=0}b=document.getElementById(a[h]);if(Boolean(b)){RemoveCssClassFromElement(b,"selected");RemoveCssClassFromElement(b,"ms-core-listMenu-selected");b.setAttribute("aria-selected","false")}}var e=document.getElementById(d);if(Boolean(e)){RemoveCssClassFromElement(e,"ms-hide");AddCssClassToElement(e,"ms-aclinv-tabbedControl-fadingEnabled");e.style.opacity=1;DOM.AddEventHandler(e,"webkitTransitionEnd",c);DOM.AddEventHandler(e,"transitionEnd",c);var g=a[d];if(Boolean(g)){var f=document.getElementById(g);if(Boolean(f)){AddCssClassToElement(f,"selected");AddCssClassToElement(f,"ms-core-listMenu-selected");Boolean(f.setAttribute)&&f.setAttribute("aria-selected","true")}}Accessibility.FocusFirstTabStop(e)}};if(e)m(b);else b()}function ab(){EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){Fb()})}function E(){EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){y("SharedWithDlg",false);DisplaySharedWithDialog(L_WebUrl,L_ListID,L_ItemID,false,false,L_ContextWebUrl)})}GetManageLinkParams=function(){return new ManageLinkParams(L_WebUrl,L_ListID,L_ItemID,!Boolean(L_AnonymousEditLink)||L_AnonymousEditLink==""?null:L_AnonymousEditLink,!Boolean(L_AnonymousViewLink)||L_AnonymousViewLink==""?null:L_AnonymousViewLink,L_CanManageLink,Eb,L_ContextWebUrl,L_SharingLinks)};function Fb(){EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){DisplayManageLinkDialog(GetManageLinkParams())})}function Eb(g,b){var a=document.getElementById("js-sharingdlg-guestLink");if(!Boolean(b)){Boolean(a)&&a.focus();return}var e=Boolean(b.editLinkDisabled),f=Boolean(b.viewLinkDisabled);if(e)L_AnonymousEditLink=null;if(f)L_AnonymousViewLink=null;if(!Boolean(L_AnonymousViewLink)&&!Boolean(L_AnonymousEditLink)){var d=document.getElementById("js-sharingdlg-guestLinkDiv");if(d!=null)d.style.display="none";Cb();c()}else Boolean(a)&&a.focus()}function vb(a){ApplySharingListStyles(a);m$(a).find(".js-sharingdlg-sharedWithLink").click(function(){var a=false,c=typeof window.top.g_childDialog!="undefined"?window.top.g_childDialog:undefined;if(Boolean(c)){var b=c.get_args();if(b!=null&&Boolean(b.LaunchedWithCallback))a=true}var d=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(17);if(d)E();else if(a)EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.commonModalDialogClose",function(){SP.UI.ModalDialog.commonModalDialogClose(100,null)});else DisplaySharedWithDialog(L_WebUrl,L_ListID,L_ItemID,false,false,L_ContextWebUrl);return false})}function z(){var a=document.getElementById("divSharingInformation");if(Boolean(a)){a.innerHTML=GetSharingStatusHtml(sharingInfo.SharedUsers,sharingInfo.IsSharedWithMany,sharingInfo.IsSharedWithSecurityGroup,sharingInfo.IsSharedWithGuest,true,L_UserDispUrl,L_ItemName);a.innerHTML.length>0&&vb(a)}}function mb(){GetListItemSharingInformation(b,a,L_WebUrl,L_ListID,L_ItemID,true,false,true,true,false,false,false);function b(b,a){I(a);z()}function a(){}}RenderDLPLite=function(o,b,n){var f=false;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(305))if(Boolean(o)){var a=[];if(Boolean(b)&&b.length>0){for(var e=[],d=[],c=0,r=b.length;c<r;c++)if(Boolean(b[c].IsResolved)){var i=p(b[c]),j=b[c].EntityData.PrincipalType;if(!Boolean(j))j=b[c].EntityType;switch(j){case SPClientPeoplePicker.PrincipalTypeGuestUser:case SPClientPeoplePicker.UnvalidatedEmailAddressKey:e.push(i);break;case"SecGroup":case"SharePointGroup":if(Boolean(b[c].EntityData.Email))d.push(i);else d.push(String.format(Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_GroupNotEmailEnabledText),i))}}var g="aclInv_listOfExternalUsers",h="aclInv_listOfGroups";if(e.length>0){a.push("<div class='ms-aclinv-sharingTips-section'>");if(e.length==1)a.push(String.format(Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_SingleExternalUserText),e[0]));else{a.push(Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_MultipleExternalUsersText));k(a,g,e.join(", "))}a.push("</div>")}if(d.length>0){var q=SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_NumberOfGroupsShared),Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_NumberOfGroupsSharedIntervals),d.length);a.push("<div class='ms-aclinv-sharingTips-section'>");a.push(String.format(q,d.length));k(a,h,d.join(", "));a.push("</div>")}}o.innerHTML=a.join("");m(g+"_ShowHide","onclick",function(){l(this,g)});m(h+"_ShowHide","onclick",function(){l(this,h)});f=a.length>0;f&&n!=null&&n()}return f;function k(a,c,e){var d=document.getElementById(c),b=false;if(Boolean(d)&&!Sys.UI.DomElement.containsCssClass(d,"ms-hide"))b=true;a.push("&nbsp;<a id="+StAttrQuote(c+"_ShowHide")+" href='javascript:;' >");a.push(Encoding.HtmlEncode(b?Strings.STS.L_DLPLite_SharingPage_HideDetailsLinkText:Strings.STS.L_DLPLite_SharingPage_ShowDetailsLinkText));a.push("</a>");a.push("<div id="+StAttrQuote(c)+" class="+StAttrQuote(b?"":"ms-hide")+">");a.push(e);a.push("</div>")}function p(a){return Boolean(a)&&Boolean(a.DisplayText)?"<span class='ms-entity-resolved'>"+Encoding.HtmlEncode(a.DisplayText)+"</span>":""}function l(c,d){var b=document.getElementById(d);Boolean(b)&&Sys.UI.DomElement.toggleCssClass(b,"ms-hide");if(Sys.UI.DomElement.containsCssClass(b,"ms-hide"))c.innerHTML=Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_ShowDetailsLinkText);else c.innerHTML=Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_HideDetailsLinkText);var a=window.frameElement;if(a==null)a=SP.UI.ModalDialog.get_childDialog();a!=null&&typeof a.autoSize==="function"&&a.autoSize()}function m(b,c,d){var a=document.getElementById(b);a!=null&&DOM.AddEventHandler(a,c,d,false)}};FormatUserEntriesForSharing=function(d){var b=d.split(","),a="";if(b.length==0)return a;a+="[";for(var c=0;c<b.length;c++){var e=b[c];a+=String.format('{{"ResolveText":"{0}","IsResolved":"false","AutoFillKey":"{0}","Key":"{0}","AutoFillDisplayText":"{0}","DisplayText":"{0}"}}',e);if(c<b.length-1)a+=","}a+="]";return a};GetWebSharingInformation=function(i,h,j,f,g,e,d,b,c,a){GetObjectSharingInformation(i,h,j,"_api/web",f,g,e,d,b,c,a)};GetListSharingInformation=function(j,a,k,b,h,i,g,f,d,e,c){if(!Boolean(b)){typeof a=="function"&&a("Invalid sharing arguments.");return}GetObjectSharingInformation(j,a,k,"_api/web/Lists/GetById(id='"+b+"')",h,i,g,f,d,e,c)};GetListItemSharingInformation=function(k,a,l,c,b,i,j,h,g,e,f,d){if(!Boolean(c)||!Boolean(b)){typeof a=="function"&&a("Invalid sharing arguments.");return}GetObjectSharingInformation(k,a,l,"_api/web/Lists/GetById(id='"+c+"')/GetItemById(id='"+b+"')",i,j,h,g,e,f,d)};GetObjectSharingInformation=function(n,c,e,d,l,m,k,j,g,i,f){if(!Boolean(e)||!Boolean(d)){typeof c=="function"&&c("Invalid sharing arguments.");return}var a=new URI(d);a.setPath(a.getPath()+"/GetObjectSharingInformation");var b=a.getQuery();b=(Boolean(b)?b+"&":"?")+"$expand=SharedWithUsersCollection";a.setQuery(b);var o=JSON.stringify({excludeCurrentUser:l,excludeSiteAdmin:m,excludeSecurityGroups:k,retrieveAnonymousLinks:j,retrieveUserInfoDetails:g,checkForAccessRequests:i,retrievePermissionLevels:f});h(n,c,e,a.getString(),o)};GetObjectSharingInformationByUrl=function(n,b,c,a,k,m,j,i,f,g,d){if(!Boolean(c)||!Boolean(a)){typeof b=="function"&&b("Invalid sharing arguments.");return}var o=new URI(a),l=Boolean(o.getScheme())?a:e(a),q="_api/SP.ObjectSharingInformation.GetObjectSharingInformationByUrl?$expand=SharedWithUsersCollection",p=JSON.stringify({objectUrl:l,excludeCurrentUser:k,excludeSiteAdmin:m,excludeSecurityGroups:j,retrieveAnonymousLinks:i,retrieveUserInfoDetails:f,checkForAccessRequests:g,retrievePermissionLevels:d});h(n,b,c,q,p)};UpdateDocumentSharingInfo=function(k,c,d,a,b,i,l,g,q,f,m){if(!Boolean(d)||!Boolean(a)||!Boolean(b)||b.length<1){typeof c=="function"&&c("Invalid sharing arguments.");return}var n=new URI(a),j=Boolean(n.getScheme())?a:e(a),p="_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo",o=JSON.stringify({resourceAddress:j,userRoleAssignments:b,validateExistingPermissions:i,additiveMode:l,sendServerManagedNotification:g,customMessage:null,includeAnonymousLinksInNotification:f,propagateAcl:m});h(k,c,d,p,o)};CreateAnonymousLink=function(b,a,f,d,c,e){P(b,a,f,d,c,true,e)};DestroyAnonymousLink=function(b,a,e,d,c){P(b,a,e,d,c,false,null)};CreateOrganizationSharingLink=function(b,a,e,d,c){J(b,a,e,d,c,true)};DestroyOrganizationSharingLink=function(b,a,e,d,c){J(b,a,e,d,c,false)};GetSharingSettings=function(l,c,i,a,g,b){if(!Boolean(i)||!Boolean(a)){typeof c=="function"&&c("Invalid sharing arguments.");return}var f=new URI(a),k=Boolean(f.getScheme())?a:e(a),n="_api/SP.Web.GetObjectSharingSettings?$expand=ObjectSharingInformation,ObjectSharingInformation/SharedWithUsersCollection,SharePointSettings,SharePointSettings/PickerProperties,SharingPermissions",d=f.getQuery(),j=Boolean(b)||(typeof b!="boolean"||b==null)&&Boolean(d)&&d.indexOf("forSharing=1")!=-1,m=JSON.stringify({objectUrl:k,groupId:isNaN(g)?0:g,useSimplifiedRoles:j});h(l,c,i,n,m)};ShareObject=function(n,b,k,a,m,p,j,f,i,c,d,g){if(!Boolean(k)||!Boolean(a)){typeof b=="function"&&b("Invalid sharing arguments.");return}var o=new URI(a),l=Boolean(o.getScheme())?a:e(a),r="_api/SP.Web.ShareObject?$expand=UsersWithAccessRequests,GroupsSharedWith",q=JSON.stringify({url:l,peoplePickerInput:m,roleValue:p,groupId:isNaN(j)?0:j,propagateAcl:Boolean(f)?f:false,sendEmail:Boolean(i)?i:false,includeAnonymousLinkInEmail:Boolean(c)?c:false,emailSubject:Boolean(d)?d:null,emailBody:Boolean(g)?g:null});h(n,b,k,r,q)};UnshareObject=function(d,c,b,i,e){var g="_api/SP.Web.UnshareObject",a={};a.url=x(b,i,e);var f=JSON.stringify(a);h(d,c,b,g,f)};ForwardObjectLink=function(j,b,f,a,i,c,d){if(!Boolean(f)||!Boolean(a)){typeof b=="function"&&b("Invalid sharing arguments.");return}var k=new URI(a),g=Boolean(k.getScheme())?a:e(a),m="_api/SP.Web.ForwardObjectLink",l=JSON.stringify({url:g,peoplePickerInput:i,emailSubject:Boolean(c)?c:null,emailBody:Boolean(d)?d:null});h(j,b,f,m,l)};function P(j,f,i,b,a,g,o){if(!Boolean(i)||!Boolean(b)){typeof f=="function"&&f("Invalid sharing arguments.");return}var m=new URI(b),d=Boolean(m.getScheme())?b:e(b),l=expiryFlightOn?"_api/SP.Web.CreateAnonymousLinkWithExpiration":"_api/SP.Web.CreateAnonymousLink",k=a==null?"_api/SP.Web.DeleteAllAnonymousLinksForObject":"_api/SP.Web.DeleteAnonymousLinkForObject",n=g?l:k,c;if(expiryFlightOn&&g)c=JSON.stringify({url:d,isEditLink:a,expirationString:o});else if(expiryFlightOn&&a==null)c=JSON.stringify({url:d});else c=JSON.stringify({url:d,isEditLink:a});h(j,f,i,n,c)}function J(c,a,i,d,g,f){if(!Boolean(i)||!Boolean(d)){typeof a=="function"&&a("Invalid sharing arguments.");return}var b=function(k,l){var j=new URI(d),b=Boolean(j.getScheme())?d:e(d),m=f?"_api/SP.Web.CreateOrganizationSharingLink":"_api/SP.Web.DestroyOrganizationSharingLink",a="";if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(566)){var c={url:b,isEditLink:g};if(!f)c.removeAssociatedSharingLinkGroup=true;a=JSON.stringify(c)}else a=JSON.stringify({url:b,isEditLink:g});h(k,l,i,m,a)};if(typeof SP!="undefined"&&typeof SP.QoS!="undefined")if(g)if(f)SP.QoS.ExecuteMonitoredAsync("SharingCreateEditLink","SharingCreateEditLinkStart","SharingCreateEditLinkSuccess","SharingCreateEditLinkFailure","SharingCreateEditLinkNoResult",b,c,a);else SP.QoS.ExecuteMonitoredAsync("SharingDisableEditLink","SharingDisableEditLinkStart","SharingDisableEditLinkSuccess","SharingDisableEditLinkFailure","SharingDisableEditLinkNoResult",b,c,a);else if(f)SP.QoS.ExecuteMonitoredAsync("SharingCreateViewLink","SharingCreateViewLinkStart","SharingCreateViewLinkSuccess","SharingCreateViewLinkFailure","SharingCreateViewLinkNoResult",b,c,a);else SP.QoS.ExecuteMonitoredAsync("SharingDisableViewLink","SharingDisableViewLinkStart","SharingDisableViewLinkSuccess","SharingDisableViewLinkFailure","SharingDisableViewLinkNoResult",b,c,a);else b(c,a)}function h(g,b,c,d,f){if(!Boolean(c)||!Boolean(d)){typeof b=="function"&&b("Invalid sharing arguments.");return}if(!Boolean(f))f=null;var i=new URI(c),a=Boolean(i.getScheme())?c:e(c),h=function(e){if(a.substring(a.length-1)=="/")a=a.substring(0,a.length-1);var h=a+(d.charAt(0)!="/"?"/":"")+d,c=new XMLHttpRequest;c.open("POST",h,true);c.setRequestHeader("Content-type","application/json;odata=verbose");c.setRequestHeader("x-requestdigest",e);c.setRequestHeader("x-requested-with","XMLHttpRequest");c.setRequestHeader("accept","application/json; odata=verbose");c.onreadystatechange=function(){if(IsXhrReady(c)){var a=null,d=null;try{a=JSON.parse(c.responseText)}catch(e){d=e}if(Boolean(a))if(Boolean(a.d)&&Boolean(a.d.ErrorMessage))d=a.d.ErrorMessage;else if(Boolean(a.error)){d="";if(Boolean(a.error.message))d=a.error.message.value}if(typeof d!="undefined"&&d!=null||!Boolean(a)||!Boolean(a.d))typeof b=="function"&&b(c,d);else typeof g=="function"&&g(c,a.d)}};c.send(f)};EnsureScript("core.js","GetRequestDigest",function(){var b=GetRequestDigest(a,h);Boolean(b)&&h(b)})}function x(b,d,f,g,h){var a=b;if(!b.endsWith("/"))b+="/";if(b.charAt(0)=="/")b=e(b);if(!(a.length>"_layouts/15/aclinv.aspx".length&&a.indexOf("_layouts/15/aclinv.aspx")>0)){var c=[b,"_layouts/15/aclinv.aspx","?forSharing=1&mbypass=1"];if(m$.isDefinedAndNotNull(d)&&d.length>0){c.push("&List=",escapeProperly(d));m$.isDefinedAndNotNull(f)&&f.length>0&&c.push("&obj=",d,",",f,",DOCUMENT")}Boolean(g)&&c.push("&tts=",g);Boolean(h)&&c.push("&ThemeOverride=","none");a=c.join("")}else if(a.charAt(0)=="/")a=e(a);return a}m$.isDefinedAndNotNull(Sys)&&m$.isDefinedAndNotNull(Sys.Application)&&Sys.Application.notifyScriptLoaded();m$.isFunction(NotifyScriptLoadedAndExecuteWaitingJobs)&&NotifyScriptLoadedAndExecuteWaitingJobs("sharing.js");function u(d,c){var a=m$,b=document;if(IsInIframe()&&Boolean(window.parent.m$)){a=window.parent.m$;b=window.parent.document}Boolean(a)&&Boolean(d)&&Boolean(c)&&a(b).trigger("SharingEvents.SharingModified",d,c)}function I(a){if(!Boolean(sharingInfo))sharingInfo={};sharingInfo.IsSharedWithMany=a.IsSharedWithMany;sharingInfo.IsSharedWithSecurityGroup=a.IsSharedWithSecurityGroup;sharingInfo.IsSharedWithGuest=a.IsSharedWithGuest;sharingInfo.SharedUsers=[];for(var e=a.SharedWithUsersCollection.results,d=0,f=e.length;d<f;d++){var c=e[d],b={};b.id=c.Id;b.title=c.Name;b.email=c.Email;sharingInfo.SharedUsers.push(b)}}})();typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkEnd_sharing.js")}var GetSharingStatusHtml,ApplySharingListStyles,DisplayClientSharingDialog,DisplaySharingDialog,DisplayUnthemedSharingDialog,RenderSharingDialogByUrl,NavigateToRootLibraryWithoutQueryString,DisplaySharedWithDialog,DisplaySharedWithDialogCore,SetSelectedPermission,CheckPermissionsFor,FormatUserEntriesForSharing,GetWebSharingInformation,GetListSharingInformation,GetListItemSharingInformation,GetObjectSharingInformation,GetObjectSharingInformationByUrl,UpdateDocumentSharingInfo,CreateAnonymousLink,DestroyAnonymousLink,CreateOrganizationSharingLink,DestroyOrganizationSharingLink,GetSharingSettings,ShareObject,UnshareObject,ForwardObjectLink,ConfigEmailLinkHelper,GetReversedSharedWithUsers,ManageLinkParams,GetManageLinkParams,DisplayManageLinkDialog,OnDisableLink,OnCreateLink,SetExpirationDropdownItem,OnDropdownClick,GenerateExpiryTextHTML,GetExpirationFromLink,OnSharingLinksMenuChanged,OnCopyLink,DismissTopDlg,DismissTopDlgAndLog,HandleOnCloseClick,SelectOnFocus,RenderDLPLite,RenderLockdownModeDialog,RenderLockdownModeInContainer,companySharingLinksFlightOn,expiryFlightOn,simpleSiteSharingFeature,sharingInfoRefactorFeature,SharingTabToShow,SharingDialogReturnCode,SharingRole,SharingLinkKind,SharingLinkExpirationValues,L_WebUrl,L_ContextWebUrl,L_ListID,L_ItemID,L_ItemName,L_ItemUrl,L_AnonymousViewLink,L_AnonymousEditLink,L_SharingLinks,L_SharingLinkProperties,L_SelectedSharingLinkKind,L_CanManageLink,L_UserDispUrl;$_global_sharing();